

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver &mdash; bornagain 0.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../../../../search.html"/>
    <link rel="top" title="bornagain 0.0.1 documentation" href="../../../../../../index.html"/>
        <link rel="up" title="bornagain.external.pyqtgraph.pyqtgraph" href="../../pyqtgraph.html"/> 

  
  <script src="../../../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../../../index.html" class="icon icon-home"> bornagain
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../bornagain.html">bornagain package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../modules.html">bornagain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../coding.html">Coding guidlines for developers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../index.html">bornagain</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../pyqtgraph.html">bornagain.external.pyqtgraph.pyqtgraph</a> &raquo;</li>
        
      <li>bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<div class="viewcode-block" id="SystemSolver"><a class="viewcode-back" href="../../../../../../bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.html#bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.SystemSolver">[docs]</a><span class="k">class</span> <span class="nc">SystemSolver</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This abstract class is used to formalize and manage user interaction with a </span>
<span class="sd">    complex system of equations (related to &quot;constraint satisfaction problems&quot;).</span>
<span class="sd">    It is often the case that devices must be controlled</span>
<span class="sd">    through a large number of free variables, and interactions between these </span>
<span class="sd">    variables make the system difficult to manage and conceptualize as a user</span>
<span class="sd">    interface. This class does _not_ attempt to numerically solve the system</span>
<span class="sd">    of equations. Rather, it provides a framework for subdividing the system</span>
<span class="sd">    into manageable pieces and specifying closed-form solutions to these small </span>
<span class="sd">    pieces.</span>
<span class="sd">    </span>
<span class="sd">    For an example, see the simple Camera class below.</span>
<span class="sd">    </span>
<span class="sd">    Theory of operation: Conceptualize the system as 1) a set of variables</span>
<span class="sd">    whose values may be either user-specified or automatically generated, and </span>
<span class="sd">    2) a set of functions that define *how* each variable should be generated. </span>
<span class="sd">    When a variable is accessed (as an instance attribute), the solver first</span>
<span class="sd">    checks to see if it already has a value (either user-supplied, or cached</span>
<span class="sd">    from a previous calculation). If it does not, then the solver calls a </span>
<span class="sd">    method on itself (the method must be named `_variableName`) that will</span>
<span class="sd">    either return the calculated value (which usually involves acccessing</span>
<span class="sd">    other variables in the system), or raise RuntimeError if it is unable to</span>
<span class="sd">    calculate the value (usually because the user has not provided sufficient</span>
<span class="sd">    input to fully constrain the system). </span>
<span class="sd">    </span>
<span class="sd">    Each method that calculates a variable value may include multiple </span>
<span class="sd">    try/except blocks, so that if one method generates a RuntimeError, it may </span>
<span class="sd">    fall back on others. </span>
<span class="sd">    In this way, the system may be solved by recursively searching the tree of </span>
<span class="sd">    possible relationships between variables. This allows the user flexibility</span>
<span class="sd">    in deciding which variables are the most important to specify, while </span>
<span class="sd">    avoiding the apparent combinatorial explosion of calculation pathways</span>
<span class="sd">    that must be considered by the developer.</span>
<span class="sd">    </span>
<span class="sd">    Solved values are cached for efficiency, and automatically cleared when </span>
<span class="sd">    a state change invalidates the cache. The rules for this are simple: any</span>
<span class="sd">    time a value is set, it invalidates the cache *unless* the previous value</span>
<span class="sd">    was None (which indicates that no other variable has yet requested that </span>
<span class="sd">    value). More complex cache management may be defined in subclasses.</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Subclasses must define:</span>
<span class="sd">    </span>
<span class="sd">    1) The *defaultState* class attribute: This is a dict containing a </span>
<span class="sd">       description of the variables in the system--their default values,</span>
<span class="sd">       data types, and the ways they can be constrained. The format is::</span>
<span class="sd">       </span>
<span class="sd">           { name: [value, type, constraint, allowed_constraints], ...}</span>
<span class="sd">       </span>
<span class="sd">       * *value* is the default value. May be None if it has not been specified</span>
<span class="sd">         yet.</span>
<span class="sd">       * *type* may be float, int, bool, np.ndarray, ...</span>
<span class="sd">       * *constraint* may be None, single value, or (min, max)</span>
<span class="sd">            * None indicates that the value is not constrained--it may be </span>
<span class="sd">              automatically generated if the value is requested.</span>
<span class="sd">       * *allowed_constraints* is a string composed of (n)one, (f)ixed, and (r)ange. </span>
<span class="sd">       </span>
<span class="sd">       Note: do not put mutable objects inside defaultState!</span>
<span class="sd">       </span>
<span class="sd">    2) For each variable that may be automatically determined, a method must </span>
<span class="sd">       be defined with the name `_variableName`. This method may either return</span>
<span class="sd">       the </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">defaultState</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;_vars&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;_currentGets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        
<div class="viewcode-block" id="SystemSolver.reset"><a class="viewcode-back" href="../../../../../../bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.html#bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.SystemSolver.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reset all variables in the solver to their default state.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currentGets</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultState</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vars</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultState</span><span class="p">[</span><span class="n">k</span><span class="p">][:]</span></div>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the value of a state variable. </span>
<span class="sd">        If None is given for the value, then the constraint will also be set to None.</span>
<span class="sd">        If a tuple is given for a scalar variable, then the tuple is used as a range constraint instead of a value.</span>
<span class="sd">        Otherwise, the constraint is set to &#39;fixed&#39;.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># First check this is a valid attribute</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="s1">&#39;fixed&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># also allow setting any other pre-existing attribute</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        
<div class="viewcode-block" id="SystemSolver.get"><a class="viewcode-back" href="../../../../../../bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.html#bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.SystemSolver.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the value for parameter *name*. </span>
<span class="sd">        </span>
<span class="sd">        If the value has not been specified, then attempt to compute it from</span>
<span class="sd">        other interacting parameters.</span>
<span class="sd">        </span>
<span class="sd">        If no value can be determined, then raise RuntimeError.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currentGets</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cyclic dependency while calculating &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currentGets</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cfunc</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">cfunc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">cfunc</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Parameter &#39;</span><span class="si">%s</span><span class="s2">&#39; is not specified.&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_currentGets</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">v</span></div>
    
<div class="viewcode-block" id="SystemSolver.set"><a class="viewcode-back" href="../../../../../../bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.html#bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.SystemSolver.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a variable *name* to *value*. The actual set value is returned (in</span>
<span class="sd">        some cases, the value may be cast into another type).</span>
<span class="sd">        </span>
<span class="sd">        If *value* is None, then the value is left to be determined in the </span>
<span class="sd">        future. At any time, the value may be re-assigned arbitrarily unless</span>
<span class="sd">        a constraint is given.</span>
<span class="sd">        </span>
<span class="sd">        If *constraint* is True (the default), then supplying a value that </span>
<span class="sd">        violates a previously specified constraint will raise an exception.</span>
<span class="sd">        </span>
<span class="sd">        If *constraint* is &#39;fixed&#39;, then the value is set (if provided) and</span>
<span class="sd">        the variable will not be updated automatically in the future.</span>

<span class="sd">        If *constraint* is a tuple, then the value is constrained to be within the </span>
<span class="sd">        given (min, max). Either constraint may be None to disable </span>
<span class="sd">        it. In some cases, a constraint cannot be satisfied automatically,</span>
<span class="sd">        and the user will be forced to resolve the constraint manually.</span>
<span class="sd">        </span>
<span class="sd">        If *constraint* is None, then any constraints are removed for the variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">constraint</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;n&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">var</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Empty constraints not allowed for &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">constraint</span>
        <span class="k">elif</span> <span class="n">constraint</span> <span class="o">==</span> <span class="s1">&#39;fixed&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;f&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">var</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Fixed constraints not allowed for &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">constraint</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">constraint</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;r&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">var</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Range constraints not allowed for &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
            <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">constraint</span>
        <span class="k">elif</span> <span class="n">constraint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;constraint must be None, True, &#39;fixed&#39;, or tuple. (got </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">constraint</span><span class="p">)</span>
        
        <span class="c1"># type checking / massaging</span>
        <span class="k">if</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">value</span><span class="p">)</span>
            
        <span class="c1"># constraint checks</span>
        <span class="k">if</span> <span class="n">constraint</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_constraint</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Setting </span><span class="si">%s</span><span class="s2"> = </span><span class="si">%s</span><span class="s2"> violates constraint </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        
        <span class="c1"># invalidate other dependent values</span>
        <span class="k">if</span> <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># todo: we can make this more clever..(and might need to) </span>
            <span class="c1"># we just know that a value of None cannot have dependencies</span>
            <span class="c1"># (because if anyone else had asked for this value, it wouldn&#39;t be </span>
            <span class="c1"># None anymore)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resetUnfixed</span><span class="p">()</span>
            
        <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">value</span></div>
    
<div class="viewcode-block" id="SystemSolver.check_constraint"><a class="viewcode-back" href="../../../../../../bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.html#bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.SystemSolver.check_constraint">[docs]</a>    <span class="k">def</span> <span class="nf">check_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">c</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">((</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">value</span><span class="p">)</span> <span class="ow">and</span>
                    <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">value</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span> <span class="o">==</span> <span class="n">c</span></div>
    
<div class="viewcode-block" id="SystemSolver.saveState"><a class="viewcode-back" href="../../../../../../bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.html#bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.SystemSolver.saveState">[docs]</a>    <span class="k">def</span> <span class="nf">saveState</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a serializable description of the solver&#39;s current state.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">state</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">state</span></div>
    
<div class="viewcode-block" id="SystemSolver.restoreState"><a class="viewcode-back" href="../../../../../../bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.html#bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.SystemSolver.restoreState">[docs]</a>    <span class="k">def</span> <span class="nf">restoreState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Restore the state of all values and constraints in the solver.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>
    
<div class="viewcode-block" id="SystemSolver.resetUnfixed"><a class="viewcode-back" href="../../../../../../bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.html#bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.SystemSolver.resetUnfixed">[docs]</a>    <span class="k">def</span> <span class="nf">resetUnfixed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For any variable that does not have a fixed value, reset</span>
<span class="sd">        its value to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;fixed&#39;</span><span class="p">:</span>
                <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></div>
                
<div class="viewcode-block" id="SystemSolver.solve"><a class="viewcode-back" href="../../../../../../bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.html#bornagain.external.pyqtgraph.pyqtgraph.parametertree.SystemSolver.SystemSolver.solve">[docs]</a>    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars</span><span class="p">:</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span></div>
                
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;fixed&#39;</span><span class="p">:</span>
                <span class="n">state</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="k">return</span> <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&gt;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span></div>





<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    
    <span class="k">class</span> <span class="nc">Camera</span><span class="p">(</span><span class="n">SystemSolver</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Consider a simple SLR camera. The variables we will consider that </span>
<span class="sd">        affect the camera&#39;s behavior while acquiring a photo are aperture, shutter speed,</span>
<span class="sd">        ISO, and flash (of course there are many more, but let&#39;s keep the example simple).</span>

<span class="sd">        In rare cases, the user wants to manually specify each of these variables and</span>
<span class="sd">        no more work needs to be done to take the photo. More often, the user wants to</span>
<span class="sd">        specify more interesting constraints like depth of field, overall exposure, </span>
<span class="sd">        or maximum allowed ISO value.</span>

<span class="sd">        If we add a simple light meter measurement into this system and an &#39;exposure&#39;</span>
<span class="sd">        variable that indicates the desired exposure (0 is &quot;perfect&quot;, -1 is one stop </span>
<span class="sd">        darker, etc), then the system of equations governing the camera behavior would</span>
<span class="sd">        have the following variables:</span>

<span class="sd">            aperture, shutter, iso, flash, exposure, light meter</span>

<span class="sd">        The first four variables are the &quot;outputs&quot; of the system (they directly drive </span>
<span class="sd">        the camera), the last is a constant (the camera itself cannot affect the </span>
<span class="sd">        reading on the light meter), and &#39;exposure&#39; specifies a desired relationship </span>
<span class="sd">        between other variables in the system.</span>

<span class="sd">        So the question is: how can I formalize a system like this as a user interface?</span>
<span class="sd">        Typical cameras have a fairly limited approach: provide the user with a list</span>
<span class="sd">        of modes, each of which defines a particular set of constraints. For example:</span>

<span class="sd">            manual: user provides aperture, shutter, iso, and flash</span>
<span class="sd">            aperture priority: user provides aperture and exposure, camera selects</span>
<span class="sd">                            iso, shutter, and flash automatically</span>
<span class="sd">            shutter priority: user provides shutter and exposure, camera selects</span>
<span class="sd">                            iso, aperture, and flash</span>
<span class="sd">            program: user specifies exposure, camera selects all other variables</span>
<span class="sd">                    automatically</span>
<span class="sd">            action: camera selects all variables while attempting to maximize </span>
<span class="sd">                    shutter speed</span>
<span class="sd">            portrait: camera selects all variables while attempting to minimize </span>
<span class="sd">                    aperture</span>

<span class="sd">        A more general approach might allow the user to provide more explicit </span>
<span class="sd">        constraints on each variable (for example: I want a shutter speed of 1/30 or </span>
<span class="sd">        slower, an ISO no greater than 400, an exposure between -1 and 1, and the </span>
<span class="sd">        smallest aperture possible given all other constraints) and have the camera </span>
<span class="sd">        solve the system of equations, with a warning if no solution is found. This</span>
<span class="sd">        is exactly what we will implement in this example class.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">defaultState</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([</span>
            <span class="c1"># Field stop aperture</span>
            <span class="p">(</span><span class="s1">&#39;aperture&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;nf&#39;</span><span class="p">]),</span>
            <span class="c1"># Duration that shutter is held open. </span>
            <span class="p">(</span><span class="s1">&#39;shutter&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;nf&#39;</span><span class="p">]),</span>
            <span class="c1"># ISO (sensitivity) value. 100, 200, 400, 800, 1600.. </span>
            <span class="p">(</span><span class="s1">&#39;iso&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;nf&#39;</span><span class="p">]),</span>
            
            <span class="c1"># Flash is a value indicating the brightness of the flash. A table</span>
            <span class="c1"># is used to decide on &quot;balanced&quot; settings for each flash level:</span>
            <span class="c1">#   0: no flash</span>
            <span class="c1">#   1: s=1/60,  a=2.0, iso=100</span>
            <span class="c1">#   2: s=1/60,  a=4.0, iso=100   ..and so on..</span>
            <span class="p">(</span><span class="s1">&#39;flash&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;nf&#39;</span><span class="p">]),</span>
            
            <span class="c1"># exposure is a value indicating how many stops brighter (+1) or</span>
            <span class="c1"># darker (-1) the photographer would like the photo to appear from</span>
            <span class="c1"># the &#39;balanced&#39; settings indicated by the light meter (see below).</span>
            <span class="p">(</span><span class="s1">&#39;exposure&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">]),</span>
            
            <span class="c1"># Let&#39;s define this as an external light meter (not affected by </span>
            <span class="c1"># aperture) with logarithmic output. We arbitrarily choose the</span>
            <span class="c1"># following settings as &quot;well balanced&quot; for each light meter value:</span>
            <span class="c1">#   -1: s=1/60,  a=2.0, iso=100</span>
            <span class="c1">#    0: s=1/60,  a=4.0, iso=100</span>
            <span class="c1">#    1: s=1/120, a=4.0, iso=100    ..and so on..</span>
            <span class="c1"># Note that the only allowed constraint mode is (f)ixed, since the</span>
            <span class="c1"># camera never _computes_ the light meter value, it only reads it.</span>
            <span class="p">(</span><span class="s1">&#39;lightMeter&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">]),</span>  
            
            <span class="c1"># Indicates the camera&#39;s final decision on how it thinks the photo will </span>
            <span class="c1"># look, given the chosen settings. This value is _only_ determined</span>
            <span class="c1"># automatically.</span>
            <span class="p">(</span><span class="s1">&#39;balance&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]),</span>
            <span class="p">])</span>
        
        <span class="k">def</span> <span class="nf">_aperture</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Determine aperture automatically under a variety of conditions.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">iso</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iso</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exposure</span>
            <span class="n">light</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lightMeter</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># shutter-priority mode</span>
                <span class="n">sh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shutter</span>   <span class="c1"># this raises RuntimeError if shutter has not</span>
                                   <span class="c1"># been specified</span>
                <span class="n">ap</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">sh</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">60.</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">iso</span> <span class="o">/</span> <span class="mf">100.</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">exp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">light</span><span class="p">)</span>
                <span class="n">ap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">16.0</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                <span class="c1"># program mode; we can select a suitable shutter</span>
                <span class="c1"># value at the same time.</span>
                <span class="n">sh</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">60.</span><span class="p">)</span>
                <span class="k">raise</span>
            
            
            
            <span class="k">return</span> <span class="n">ap</span>

        <span class="k">def</span> <span class="nf">_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">iso</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iso</span>
            <span class="n">light</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lightMeter</span>
            <span class="n">sh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shutter</span>
            <span class="n">ap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aperture</span>
            <span class="n">fl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flash</span>
            
            <span class="n">bal</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">/</span> <span class="n">ap</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">sh</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">60.</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">iso</span> <span class="o">/</span> <span class="mf">100.</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">light</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">bal</span><span class="p">)</span>
    
    <span class="n">camera</span> <span class="o">=</span> <span class="n">Camera</span><span class="p">()</span>
    
    <span class="n">camera</span><span class="o">.</span><span class="n">iso</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">camera</span><span class="o">.</span><span class="n">exposure</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">camera</span><span class="o">.</span><span class="n">lightMeter</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">camera</span><span class="o">.</span><span class="n">shutter</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">60.</span>
    <span class="n">camera</span><span class="o">.</span><span class="n">flash</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="n">camera</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">camera</span><span class="o">.</span><span class="n">saveState</span><span class="p">())</span>
    
</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Richard A Kirian.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../../../',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>