

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox &mdash; bornagain 0.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../../../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../../../../../search.html"/>
    <link rel="top" title="bornagain 0.0.1 documentation" href="../../../../../../../index.html"/>
        <link rel="up" title="bornagain.external.pyqtgraph.pyqtgraph" href="../../../pyqtgraph.html"/> 

  
  <script src="../../../../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../../../../index.html" class="icon icon-home"> bornagain
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../bornagain.html">bornagain package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../modules.html">bornagain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../coding.html">Coding guidlines for developers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../../index.html">bornagain</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../../../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../../pyqtgraph.html">bornagain.external.pyqtgraph.pyqtgraph</a> &raquo;</li>
        
      <li>bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">...Qt</span> <span class="k">import</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtCore</span>
<span class="kn">from</span> <span class="nn">...python2_3</span> <span class="k">import</span> <span class="n">sortList</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">...Point</span> <span class="k">import</span> <span class="n">Point</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="k">import</span> <span class="n">functions</span> <span class="k">as</span> <span class="n">fn</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="n">ItemGroup</span> <span class="kn">import</span> <span class="nn">ItemGroup</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="n">GraphicsWidget</span> <span class="kn">import</span> <span class="nn">GraphicsWidget</span>
<span class="kn">import</span> <span class="nn">weakref</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="k">import</span> <span class="n">debug</span> <span class="k">as</span> <span class="n">debug</span>
<span class="kn">from</span> <span class="nn">...</span> <span class="k">import</span> <span class="n">getConfigOption</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">...Qt</span> <span class="k">import</span> <span class="n">isQObjectAlive</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ViewBox&#39;</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">WeakList</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_items</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="c1">#Add backwards to iterate backwards (to make iterating more efficient on removal).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_items</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_items</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">ref</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">d</span>
            <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>

<span class="k">class</span> <span class="nc">ChildGroup</span><span class="p">(</span><span class="n">ItemGroup</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="n">ItemGroup</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        
        <span class="c1"># Used as callback to inform ViewBox when items are added/removed from </span>
        <span class="c1"># the group. </span>
        <span class="c1"># Note 1: We would prefer to override itemChange directly on the </span>
        <span class="c1">#         ViewBox, but this causes crashes on PySide.</span>
        <span class="c1"># Note 2: We might also like to use a signal rather than this callback</span>
        <span class="c1">#         mechanism, but this causes a different PySide crash.        </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">itemsChangedListeners</span> <span class="o">=</span> <span class="n">WeakList</span><span class="p">()</span>
 
        <span class="c1"># excempt from telling view when transform changes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_GraphicsObject__inform_view_on_change</span> <span class="o">=</span> <span class="kc">False</span>
    
    <span class="k">def</span> <span class="nf">itemChange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">change</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">ItemGroup</span><span class="o">.</span><span class="n">itemChange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">change</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">change</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ItemChildAddedChange</span> <span class="ow">or</span> <span class="n">change</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ItemChildRemovedChange</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">itemsChangedListeners</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemsChangedListeners</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="c1"># It&#39;s possible that the attribute was already collected when the itemChange happened</span>
                <span class="c1"># (if it was triggered during the gc of the object).</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">itemsChangedListeners</span><span class="p">:</span>
                    <span class="n">listener</span><span class="o">.</span><span class="n">itemsChanged</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ret</span>


<div class="viewcode-block" id="ViewBox"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox">[docs]</a><span class="k">class</span> <span class="nc">ViewBox</span><span class="p">(</span><span class="n">GraphicsWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Bases:** :class:`GraphicsWidget &lt;pyqtgraph.GraphicsWidget&gt;`</span>
<span class="sd">    </span>
<span class="sd">    Box that allows internal scaling/panning of children by mouse drag. </span>
<span class="sd">    This class is usually created automatically as part of a :class:`PlotItem &lt;pyqtgraph.PlotItem&gt;` or :class:`Canvas &lt;pyqtgraph.canvas.Canvas&gt;` or with :func:`GraphicsLayout.addViewBox() &lt;pyqtgraph.GraphicsLayout.addViewBox&gt;`.</span>
<span class="sd">    </span>
<span class="sd">    Features:</span>
<span class="sd">    </span>
<span class="sd">    * Scaling contents by mouse or auto-scale when contents change</span>
<span class="sd">    * View linking--multiple views display the same data ranges</span>
<span class="sd">    * Configurable by context menu</span>
<span class="sd">    * Item coordinate mapping methods</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">sigYRangeChanged</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="nb">object</span><span class="p">)</span>
    <span class="n">sigXRangeChanged</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="nb">object</span><span class="p">)</span>
    <span class="n">sigRangeChangedManually</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
    <span class="n">sigRangeChanged</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="nb">object</span><span class="p">)</span>
    <span class="c1">#sigActionPositionChanged = QtCore.Signal(object)</span>
    <span class="n">sigStateChanged</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
    <span class="n">sigTransformChanged</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
    <span class="n">sigResized</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
    
    <span class="c1">## mouse modes</span>
    <span class="n">PanMode</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">RectMode</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="c1">## axes</span>
    <span class="n">XAxis</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">YAxis</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">XYAxes</span> <span class="o">=</span> <span class="mi">2</span>
    
    <span class="c1">## for linking views together</span>
    <span class="n">NamedViews</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">WeakValueDictionary</span><span class="p">()</span>   <span class="c1"># name: ViewBox</span>
    <span class="n">AllViews</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">WeakKeyDictionary</span><span class="p">()</span>       <span class="c1"># ViewBox: None</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lockAspect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">enableMouse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">invertY</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">enableMenu</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">invertX</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ==============  =============================================================</span>
<span class="sd">        **Arguments:**</span>
<span class="sd">        *parent*        (QGraphicsWidget) Optional parent widget</span>
<span class="sd">        *border*        (QPen) Do draw a border around the view, give any</span>
<span class="sd">                        single argument accepted by :func:`mkPen &lt;pyqtgraph.mkPen&gt;`</span>
<span class="sd">        *lockAspect*    (False or float) The aspect ratio to lock the view</span>
<span class="sd">                        coorinates to. (or False to allow the ratio to change)</span>
<span class="sd">        *enableMouse*   (bool) Whether mouse can be used to scale/pan the view</span>
<span class="sd">        *invertY*       (bool) See :func:`invertY &lt;pyqtgraph.ViewBox.invertY&gt;`</span>
<span class="sd">        *invertX*       (bool) See :func:`invertX &lt;pyqtgraph.ViewBox.invertX&gt;`</span>
<span class="sd">        *enableMenu*    (bool) Whether to display a context menu when </span>
<span class="sd">                        right-clicking on the ViewBox background.</span>
<span class="sd">        *name*          (str) Used to register this ViewBox so that it appears</span>
<span class="sd">                        in the &quot;Link axis&quot; dropdown inside other ViewBox</span>
<span class="sd">                        context menus. This allows the user to manually link</span>
<span class="sd">                        the axes of any other view to this one. </span>
<span class="sd">        ==============  =============================================================</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">GraphicsWidget</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linksBlocked</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addedItems</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#self.gView = view</span>
        <span class="c1">#self.showGrid = showGrid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matrixNeedsUpdate</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1">## indicates that range has changed, but matrix update was deferred</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_autoRangeNeedsUpdate</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1">## indicates auto-range needs to be recomputed.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_lastScene</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">## stores reference to the last known scene this view was a part of.</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="p">{</span>
            
            <span class="c1">## separating targetRange and viewRange allows the view to be resized</span>
            <span class="c1">## while keeping all previously viewed contents visible</span>
            <span class="s1">&#39;targetRange&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span>   <span class="c1">## child coord. range visible [[xmin, xmax], [ymin, ymax]]</span>
            <span class="s1">&#39;viewRange&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span>     <span class="c1">## actual range viewed</span>
        
            <span class="s1">&#39;yInverted&#39;</span><span class="p">:</span> <span class="n">invertY</span><span class="p">,</span>
            <span class="s1">&#39;xInverted&#39;</span><span class="p">:</span> <span class="n">invertX</span><span class="p">,</span>
            <span class="s1">&#39;aspectLocked&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>    <span class="c1">## False if aspect is unlocked, otherwise float specifies the locked ratio.</span>
            <span class="s1">&#39;autoRange&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>  <span class="c1">## False if auto range is disabled, </span>
                                          <span class="c1">## otherwise float gives the fraction of data that is visible</span>
            <span class="s1">&#39;autoPan&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>         <span class="c1">## whether to only pan (do not change scaling) when auto-range is enabled</span>
            <span class="s1">&#39;autoVisibleOnly&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="c1">## whether to auto-range only to the visible portion of a plot </span>
            <span class="s1">&#39;linkedViews&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>  <span class="c1">## may be None, &quot;viewName&quot;, or weakref.ref(view)</span>
                                          <span class="c1">## a name string indicates that the view *should* link to another, but no view with that name exists yet.</span>
            
            <span class="s1">&#39;mouseEnabled&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">enableMouse</span><span class="p">,</span> <span class="n">enableMouse</span><span class="p">],</span>
            <span class="s1">&#39;mouseMode&#39;</span><span class="p">:</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">PanMode</span> <span class="k">if</span> <span class="n">getConfigOption</span><span class="p">(</span><span class="s1">&#39;leftButtonPan&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">RectMode</span><span class="p">,</span>  
            <span class="s1">&#39;enableMenu&#39;</span><span class="p">:</span> <span class="n">enableMenu</span><span class="p">,</span>
            <span class="s1">&#39;wheelScaleFactor&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">8.0</span><span class="p">,</span>

            <span class="s1">&#39;background&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            
            <span class="c1"># Limits</span>
            <span class="s1">&#39;limits&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;xLimits&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>   <span class="c1"># Maximum and minimum visible X values </span>
                <span class="s1">&#39;yLimits&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>   <span class="c1"># Maximum and minimum visible Y values  </span>
                <span class="s1">&#39;xRange&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>   <span class="c1"># Maximum and minimum X range</span>
                <span class="s1">&#39;yRange&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>   <span class="c1"># Maximum and minimum Y range </span>
                <span class="p">}</span>
            
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_updatingRange</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1">## Used to break recursive loops. See updateAutoRange.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_itemBoundsCache</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">WeakKeyDictionary</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">locateGroup</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">## items displayed when using ViewBox.locate(item)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">setFlag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ItemClipsChildrenToShape</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFlag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ItemIsFocusable</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1">## so we can receive key presses</span>
        
        <span class="c1">## childGroup is required so that ViewBox has local coordinates similar to device coordinates.</span>
        <span class="c1">## this is a workaround for a Qt + OpenGL bug that causes improper clipping</span>
        <span class="c1">## https://bugreports.qt.nokia.com/browse/QTBUG-23723</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span> <span class="o">=</span> <span class="n">ChildGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span><span class="o">.</span><span class="n">itemsChangedListeners</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="o">-</span><span class="mf">1e6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">mkPen</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateBackground</span><span class="p">()</span>
        
        <span class="c1">#self.useLeftButtonPan = pyqtgraph.getConfigOption(&#39;leftButtonPan&#39;) # normally use left button to pan</span>
        <span class="c1"># this also enables capture of keyPressEvents.</span>
        
        <span class="c1">## Make scale box that is shown when dragging on the view</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rbScaleBox</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rbScaleBox</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">mkPen</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rbScaleBox</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">mkBrush</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rbScaleBox</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="mf">1e9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rbScaleBox</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rbScaleBox</span><span class="p">,</span> <span class="n">ignoreBounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="c1">## show target rect for debugging</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">mkPen</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">axHistory</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># maintain a history of zoom locations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axHistoryPointer</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1"># pointer into the history. Allows forward/backward movement, not just &quot;undo&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">setAspectLocked</span><span class="p">(</span><span class="n">lockAspect</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">mkPen</span><span class="p">(</span><span class="n">border</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span> <span class="o">=</span> <span class="n">ViewBoxMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateViewLists</span><span class="p">()</span>
        
<div class="viewcode-block" id="ViewBox.register"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.register">[docs]</a>    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add this ViewBox to the registered list of views. </span>
<span class="sd">        </span>
<span class="sd">        This allows users to manually link the axes of any other ViewBox to</span>
<span class="sd">        this one. The specified *name* will appear in the drop-down lists for </span>
<span class="sd">        axis linking in the context menus of all other views.</span>
<span class="sd">        </span>
<span class="sd">        The same can be accomplished by initializing the ViewBox with the *name* attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ViewBox</span><span class="o">.</span><span class="n">AllViews</span><span class="p">[</span><span class="bp">self</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">NamedViews</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ViewBox</span><span class="o">.</span><span class="n">NamedViews</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="n">ViewBox</span><span class="o">.</span><span class="n">updateAllViewLists</span><span class="p">()</span>
            <span class="n">sid</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">destroyed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">forgetView</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">ViewBox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;sid&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">())</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span></div>
            <span class="c1">#self.destroyed.connect(self.unregister)</span>

<div class="viewcode-block" id="ViewBox.unregister"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.unregister">[docs]</a>    <span class="k">def</span> <span class="nf">unregister</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove this ViewBox from the list of linkable views. (see :func:`register() &lt;pyqtgraph.ViewBox.register&gt;`)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">AllViews</span><span class="p">[</span><span class="bp">self</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">NamedViews</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span></div>

<div class="viewcode-block" id="ViewBox.close"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unregister</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewBox.implements"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.implements">[docs]</a>    <span class="k">def</span> <span class="nf">implements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">interface</span> <span class="o">==</span> <span class="s1">&#39;ViewBox&#39;</span></div>
        
    <span class="c1"># removed due to https://bugreports.qt-project.org/browse/PYSIDE-86</span>
    <span class="c1">#def itemChange(self, change, value):</span>
        <span class="c1">## Note: Calling QWidget.itemChange causes segv in python 3 + PyQt</span>
        <span class="c1">##ret = QtGui.QGraphicsItem.itemChange(self, change, value)</span>
        <span class="c1">#ret = GraphicsWidget.itemChange(self, change, value)</span>
        <span class="c1">#if change == self.ItemSceneChange:</span>
            <span class="c1">#scene = self.scene()</span>
            <span class="c1">#if scene is not None and hasattr(scene, &#39;sigPrepareForPaint&#39;):</span>
                <span class="c1">#scene.sigPrepareForPaint.disconnect(self.prepareForPaint)</span>
        <span class="c1">#elif change == self.ItemSceneHasChanged:</span>
            <span class="c1">#scene = self.scene()</span>
            <span class="c1">#if scene is not None and hasattr(scene, &#39;sigPrepareForPaint&#39;):</span>
                <span class="c1">#scene.sigPrepareForPaint.connect(self.prepareForPaint)</span>
        <span class="c1">#return ret</span>
        
<div class="viewcode-block" id="ViewBox.checkSceneChange"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.checkSceneChange">[docs]</a>    <span class="k">def</span> <span class="nf">checkSceneChange</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ViewBox needs to receive sigPrepareForPaint from its scene before </span>
        <span class="c1"># being painted. However, we have no way of being informed when the</span>
        <span class="c1"># scene has changed in order to make this connection. The usual way</span>
        <span class="c1"># to do this is via itemChange(), but bugs prevent this approach</span>
        <span class="c1"># (see above). Instead, we simply check at every paint to see whether</span>
        <span class="c1"># (the scene has changed.</span>
        <span class="n">scene</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">scene</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lastScene</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lastScene</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lastScene</span><span class="p">,</span> <span class="s1">&#39;sigPrepareForPaint&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lastScene</span><span class="o">.</span><span class="n">sigPrepareForPaint</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prepareForPaint</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">scene</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">scene</span><span class="p">,</span> <span class="s1">&#39;sigPrepareForPaint&#39;</span><span class="p">):</span>
            <span class="n">scene</span><span class="o">.</span><span class="n">sigPrepareForPaint</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prepareForPaint</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepareForPaint</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lastScene</span> <span class="o">=</span> <span class="n">scene</span></div>
            
            
        

<div class="viewcode-block" id="ViewBox.prepareForPaint"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.prepareForPaint">[docs]</a>    <span class="k">def</span> <span class="nf">prepareForPaint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#autoRangeEnabled = (self.state[&#39;autoRange&#39;][0] is not False) or (self.state[&#39;autoRange&#39;][1] is not False)</span>
        <span class="c1"># don&#39;t check whether auto range is enabled here--only check when setting dirty flag.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_autoRangeNeedsUpdate</span><span class="p">:</span> <span class="c1"># and autoRangeEnabled: </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateAutoRange</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrixNeedsUpdate</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateMatrix</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="ViewBox.getState"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.getState">[docs]</a>    <span class="k">def</span> <span class="nf">getState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the current state of the ViewBox. </span>
<span class="sd">        Linked views are always converted to view names in the returned state.&quot;&quot;&quot;</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">views</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;linkedViews&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">):</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
                <span class="n">views</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">views</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">state</span><span class="p">[</span><span class="s1">&#39;linkedViews&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">views</span>
        <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">state</span></div>
        
<div class="viewcode-block" id="ViewBox.setState"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.setState">[docs]</a>    <span class="k">def</span> <span class="nf">setState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Restore the state of this ViewBox.</span>
<span class="sd">        (see also getState)&quot;&quot;&quot;</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setXLink</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;linkedViews&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setYLink</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;linkedViews&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">del</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;linkedViews&#39;</span><span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="c1">#self.updateMatrix()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateViewRange</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigStateChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewBox.setBackgroundColor"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.setBackgroundColor">[docs]</a>    <span class="k">def</span> <span class="nf">setBackgroundColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the background color of the ViewBox.</span>
<span class="sd">        </span>
<span class="sd">        If color is None, then no background will be drawn.</span>
<span class="sd">        </span>
<span class="sd">        Added in version 0.9.9</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateBackground</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewBox.setMouseMode"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.setMouseMode">[docs]</a>    <span class="k">def</span> <span class="nf">setMouseMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the mouse interaction mode. *mode* must be either ViewBox.PanMode or ViewBox.RectMode.</span>
<span class="sd">        In PanMode, the left mouse button pans the view and the right button scales.</span>
<span class="sd">        In RectMode, the left button draws a rectangle which updates the visible region (this mode is more suitable for single-button mice)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ViewBox</span><span class="o">.</span><span class="n">PanMode</span><span class="p">,</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">RectMode</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Mode must be ViewBox.PanMode or ViewBox.RectMode&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;mouseMode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigStateChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="c1">#def toggleLeftAction(self, act):  ## for backward compatibility</span>
        <span class="c1">#if act.text() is &#39;pan&#39;:</span>
            <span class="c1">#self.setLeftButtonAction(&#39;pan&#39;)</span>
        <span class="c1">#elif act.text() is &#39;zoom&#39;:</span>
            <span class="c1">#self.setLeftButtonAction(&#39;rect&#39;)</span>

<div class="viewcode-block" id="ViewBox.setLeftButtonAction"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.setLeftButtonAction">[docs]</a>    <span class="k">def</span> <span class="nf">setLeftButtonAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rect&#39;</span><span class="p">):</span>  <span class="c1">## for backward compatibility</span>
        <span class="k">if</span> <span class="n">mode</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;rect&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setMouseMode</span><span class="p">(</span><span class="n">ViewBox</span><span class="o">.</span><span class="n">RectMode</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">mode</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;pan&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setMouseMode</span><span class="p">(</span><span class="n">ViewBox</span><span class="o">.</span><span class="n">PanMode</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;graphicsItems:ViewBox:setLeftButtonAction: unknown mode = </span><span class="si">%s</span><span class="s1"> (Options are &quot;pan&quot; and &quot;rect&quot;)&#39;</span> <span class="o">%</span> <span class="n">mode</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="ViewBox.innerSceneItem"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.innerSceneItem">[docs]</a>    <span class="k">def</span> <span class="nf">innerSceneItem</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span></div>
    
<div class="viewcode-block" id="ViewBox.setMouseEnabled"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.setMouseEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">setMouseEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set whether each axis is enabled for mouse interaction. *x*, *y* arguments must be True or False.</span>
<span class="sd">        This allows the user to pan/scale one axis of the view while leaving the other axis unchanged.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;mouseEnabled&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;mouseEnabled&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigStateChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="ViewBox.mouseEnabled"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.mouseEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">mouseEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;mouseEnabled&#39;</span><span class="p">][:]</span></div>
        
<div class="viewcode-block" id="ViewBox.setMenuEnabled"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.setMenuEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">setMenuEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enableMenu</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;enableMenu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enableMenu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigStateChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewBox.menuEnabled"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.menuEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">menuEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;enableMenu&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>       </div>
    
<div class="viewcode-block" id="ViewBox.addItem"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.addItem">[docs]</a>    <span class="k">def</span> <span class="nf">addItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">ignoreBounds</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a QGraphicsItem to this view. The view will include this item when determining how to set its range</span>
<span class="sd">        automatically unless *ignoreBounds* is True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">zValue</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">zValue</span><span class="p">():</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zValue</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">scene</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">scene</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scene</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">item</span><span class="o">.</span><span class="n">scene</span><span class="p">():</span>
            <span class="n">scene</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>  <span class="c1">## Necessary due to Qt bug: https://bugreports.qt-project.org/browse/QTBUG-18616</span>
        <span class="n">item</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignoreBounds</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addedItems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateAutoRange</span><span class="p">()</span></div>
        <span class="c1">#print &quot;addItem:&quot;, item, item.boundingRect()</span>
        
<div class="viewcode-block" id="ViewBox.removeItem"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.removeItem">[docs]</a>    <span class="k">def</span> <span class="nf">removeItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove an item from this view.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addedItems</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateAutoRange</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewBox.clear"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">addedItems</span><span class="p">[:]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span><span class="o">.</span><span class="n">childItems</span><span class="p">():</span>
            <span class="n">ch</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="ViewBox.resizeEvent"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.resizeEvent">[docs]</a>    <span class="k">def</span> <span class="nf">resizeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linkedXChanged</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linkedYChanged</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateAutoRange</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateViewRange</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matrixNeedsUpdate</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigStateChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">setRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigResized</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="ViewBox.viewRange"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.viewRange">[docs]</a>    <span class="k">def</span> <span class="nf">viewRange</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a the view&#39;s visible range as a list: [[xmin, xmax], [ymin, ymax]]&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[:]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">]]</span>  <span class="c1">## return copy</span></div>

<div class="viewcode-block" id="ViewBox.viewRect"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.viewRect">[docs]</a>    <span class="k">def</span> <span class="nf">viewRect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a QRectF bounding the region visible within the ViewBox&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">vr0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">vr1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="n">vr0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vr1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vr0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">vr0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vr1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vr1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;make qrectf failed:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">])</span>
            <span class="k">raise</span></div>
    
<div class="viewcode-block" id="ViewBox.targetRange"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.targetRange">[docs]</a>    <span class="k">def</span> <span class="nf">targetRange</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[:]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;targetRange&#39;</span><span class="p">]]</span>  <span class="c1">## return copy</span></div>
    
<div class="viewcode-block" id="ViewBox.targetRect"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.targetRect">[docs]</a>    <span class="k">def</span> <span class="nf">targetRect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the region which has been requested to be visible. </span>
<span class="sd">        (this is not necessarily the same as the region that is *actually* visible--</span>
<span class="sd">        resizing and aspect ratio constraints can cause targetRect() and viewRect() to differ)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tr0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;targetRange&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">tr1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;targetRange&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="n">tr0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tr1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tr0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tr0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tr1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tr1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;make qrectf failed:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;targetRange&#39;</span><span class="p">])</span>
            <span class="k">raise</span></div>

    <span class="k">def</span> <span class="nf">_resetTarget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Reset target range to exactly match current view range.</span>
        <span class="c1"># This is used during mouse interaction to prevent unpredictable</span>
        <span class="c1"># behavior (because the user is unaware of targetRange).</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;aspectLocked&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span> <span class="c1"># (interferes with aspect locking)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;targetRange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]]</span>

<div class="viewcode-block" id="ViewBox.setRange"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.setRange">[docs]</a>    <span class="k">def</span> <span class="nf">setRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xRange</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yRange</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">disableAutoRange</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the visible range of the ViewBox.</span>
<span class="sd">        Must specify at least one of *rect*, *xRange*, or *yRange*. </span>
<span class="sd">        </span>
<span class="sd">        ================== =====================================================================</span>
<span class="sd">        **Arguments:**</span>
<span class="sd">        *rect*             (QRectF) The full range that should be visible in the view box.</span>
<span class="sd">        *xRange*           (min,max) The range that should be visible along the x-axis.</span>
<span class="sd">        *yRange*           (min,max) The range that should be visible along the y-axis.</span>
<span class="sd">        *padding*          (float) Expand the view by a fraction of the requested range. </span>
<span class="sd">                           By default, this value is set between 0.02 and 0.1 depending on</span>
<span class="sd">                           the size of the ViewBox.</span>
<span class="sd">        *update*           (bool) If True, update the range of the ViewBox immediately. </span>
<span class="sd">                           Otherwise, the update is deferred until before the next render.</span>
<span class="sd">        *disableAutoRange* (bool) If True, auto-ranging is diabled. Otherwise, it is left</span>
<span class="sd">                           unchanged.</span>
<span class="sd">        ================== =====================================================================</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#print self.name, &quot;ViewBox.setRange&quot;, rect, xRange, yRange, padding</span>
        <span class="c1">#import traceback</span>
        <span class="c1">#traceback.print_stack()</span>
        
        <span class="n">changes</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1"># axes</span>
        <span class="n">setRequested</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">rect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">changes</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span><span class="p">(),</span> <span class="n">rect</span><span class="o">.</span><span class="n">right</span><span class="p">()],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">(),</span> <span class="n">rect</span><span class="o">.</span><span class="n">bottom</span><span class="p">()]}</span>
            <span class="n">setRequested</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">xRange</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">changes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">xRange</span>
            <span class="n">setRequested</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">yRange</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">changes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">yRange</span>
            <span class="n">setRequested</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">changes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Must specify at least one of rect, xRange, or yRange. (gave rect=</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">rect</span><span class="p">)))</span>
        
        <span class="c1"># Update axes one at a time</span>
        <span class="n">changed</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="nb">range</span> <span class="ow">in</span> <span class="n">changes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">mn</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">range</span><span class="p">)</span>
            <span class="n">mx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">range</span><span class="p">)</span>
            
            <span class="c1"># If we requested 0 range, try to preserve previous scale. </span>
            <span class="c1"># Otherwise just pick an arbitrary scale.</span>
            <span class="k">if</span> <span class="n">mn</span> <span class="o">==</span> <span class="n">mx</span><span class="p">:</span>   
                <span class="n">dy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">][</span><span class="n">ax</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">][</span><span class="n">ax</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">dy</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">dy</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">mn</span> <span class="o">-=</span> <span class="n">dy</span><span class="o">*</span><span class="mf">0.5</span>
                <span class="n">mx</span> <span class="o">+=</span> <span class="n">dy</span><span class="o">*</span><span class="mf">0.5</span>
                <span class="n">xpad</span> <span class="o">=</span> <span class="mf">0.0</span>
                
            <span class="c1"># Make sure no nan/inf get through</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">([</span><span class="n">mn</span><span class="p">,</span> <span class="n">mx</span><span class="p">])):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot set range [</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mn</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">mx</span><span class="p">)))</span>
            
            <span class="c1"># Apply padding</span>
            <span class="k">if</span> <span class="n">padding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">xpad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">suggestPadding</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xpad</span> <span class="o">=</span> <span class="n">padding</span>
            <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">mx</span><span class="o">-</span><span class="n">mn</span><span class="p">)</span> <span class="o">*</span> <span class="n">xpad</span>
            <span class="n">mn</span> <span class="o">-=</span> <span class="n">p</span>
            <span class="n">mx</span> <span class="o">+=</span> <span class="n">p</span>
            
            <span class="c1"># Set target range</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;targetRange&#39;</span><span class="p">][</span><span class="n">ax</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[</span><span class="n">mn</span><span class="p">,</span> <span class="n">mx</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;targetRange&#39;</span><span class="p">][</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mn</span><span class="p">,</span> <span class="n">mx</span><span class="p">]</span>
                <span class="n">changed</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                
        <span class="c1"># Update viewRange to match targetRange as closely as possible while </span>
        <span class="c1"># accounting for aspect ratio constraint</span>
        <span class="n">lockX</span><span class="p">,</span> <span class="n">lockY</span> <span class="o">=</span> <span class="n">setRequested</span>
        <span class="k">if</span> <span class="n">lockX</span> <span class="ow">and</span> <span class="n">lockY</span><span class="p">:</span>
            <span class="n">lockX</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">lockY</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateViewRange</span><span class="p">(</span><span class="n">lockX</span><span class="p">,</span> <span class="n">lockY</span><span class="p">)</span>
            
        <span class="c1"># Disable auto-range for each axis that was requested to be set</span>
        <span class="k">if</span> <span class="n">disableAutoRange</span><span class="p">:</span>
            <span class="n">xOff</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">setRequested</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">yOff</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">setRequested</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">enableAutoRange</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xOff</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">yOff</span><span class="p">)</span>
            <span class="n">changed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># If nothing has changed, we are done.</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">changed</span><span class="p">):</span>
            <span class="c1">#if update and self.matrixNeedsUpdate:</span>
                <span class="c1">#self.updateMatrix(changed)</span>
            <span class="c1">#return </span>
        
            <span class="bp">self</span><span class="o">.</span><span class="n">sigStateChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            
            <span class="c1"># Update target rect for debugging</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">isVisible</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">setRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapRectFromItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">targetRect</span><span class="p">()))</span>
                
        <span class="c1"># If ortho axes have auto-visible-only, update them now</span>
        <span class="c1"># Note that aspect ratio constraints and auto-visible probably do not work together..</span>
        <span class="k">if</span> <span class="n">changed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoVisibleOnly&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoRange&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_autoRangeNeedsUpdate</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1">#self.updateAutoRange()  ## Maybe just indicate that auto range needs to be updated?</span>
        <span class="k">elif</span> <span class="n">changed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoVisibleOnly&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoRange&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_autoRangeNeedsUpdate</span> <span class="o">=</span> <span class="kc">True</span></div>
            <span class="c1">#self.updateAutoRange()</span>
            
        <span class="c1">## Update view matrix only if requested</span>
        <span class="c1">#if update:</span>
            <span class="c1">#self.updateMatrix(changed)</span>
        <span class="c1">## Otherwise, indicate that the matrix needs to be updated</span>
        <span class="c1">#else:</span>
            <span class="c1">#self.matrixNeedsUpdate = True</span>
            
        <span class="c1">## Inform linked views that the range has changed &lt;&lt;This should be moved&gt;&gt;</span>
        <span class="c1">#for ax, range in changes.items():</span>
            <span class="c1">#link = self.linkedView(ax)</span>
            <span class="c1">#if link is not None:</span>
                <span class="c1">#link.linkedViewChanged(self, ax)</span>


            
<div class="viewcode-block" id="ViewBox.setYRange"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.setYRange">[docs]</a>    <span class="k">def</span> <span class="nf">setYRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the visible Y range of the view to [*min*, *max*]. </span>
<span class="sd">        The *padding* argument causes the range to be set larger by the fraction specified.</span>
<span class="sd">        (by default, this value is between 0.02 and 0.1 depending on the size of the ViewBox)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="n">yRange</span><span class="o">=</span><span class="p">[</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">],</span> <span class="n">update</span><span class="o">=</span><span class="n">update</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="ViewBox.setXRange"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.setXRange">[docs]</a>    <span class="k">def</span> <span class="nf">setXRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the visible X range of the view to [*min*, *max*]. </span>
<span class="sd">        The *padding* argument causes the range to be set larger by the fraction specified.</span>
<span class="sd">        (by default, this value is between 0.02 and 0.1 depending on the size of the ViewBox)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="n">xRange</span><span class="o">=</span><span class="p">[</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">],</span> <span class="n">update</span><span class="o">=</span><span class="n">update</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewBox.autoRange"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.autoRange">[docs]</a>    <span class="k">def</span> <span class="nf">autoRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">items</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">item</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the range of the view box to make all children visible.</span>
<span class="sd">        Note that this is not the same as enableAutoRange, which causes the view to </span>
<span class="sd">        automatically auto-range whenever its contents are changed.</span>
<span class="sd">        </span>
<span class="sd">        ==============  ============================================================</span>
<span class="sd">        **Arguments:**</span>
<span class="sd">        padding         The fraction of the total data range to add on to the final</span>
<span class="sd">                        visible range. By default, this value is set between 0.02</span>
<span class="sd">                        and 0.1 depending on the size of the ViewBox.</span>
<span class="sd">        items           If specified, this is a list of items to consider when</span>
<span class="sd">                        determining the visible range.</span>
<span class="sd">        ==============  ============================================================</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">childrenBoundingRect</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="n">items</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: ViewBox.autoRange(item=__) is deprecated. Use &#39;items&#39; argument instead.&quot;</span><span class="p">)</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapFromItemToView</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">())</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>
            
        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="ViewBox.suggestPadding"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.suggestPadding">[docs]</a>    <span class="k">def</span> <span class="nf">suggestPadding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="k">if</span> <span class="n">axis</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">padding</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">l</span><span class="o">**</span><span class="mf">0.5</span><span class="p">),</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">padding</span> <span class="o">=</span> <span class="mf">0.02</span>
        <span class="k">return</span> <span class="n">padding</span></div>
    
<div class="viewcode-block" id="ViewBox.setLimits"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.setLimits">[docs]</a>    <span class="k">def</span> <span class="nf">setLimits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set limits that constrain the possible view ranges.</span>
<span class="sd">        </span>
<span class="sd">        **Panning limits**. The following arguments define the region within the </span>
<span class="sd">        viewbox coordinate system that may be accessed by panning the view.</span>
<span class="sd">        </span>
<span class="sd">        =========== ============================================================</span>
<span class="sd">        xMin        Minimum allowed x-axis value</span>
<span class="sd">        xMax        Maximum allowed x-axis value</span>
<span class="sd">        yMin        Minimum allowed y-axis value</span>
<span class="sd">        yMax        Maximum allowed y-axis value</span>
<span class="sd">        =========== ============================================================        </span>
<span class="sd">        </span>
<span class="sd">        **Scaling limits**. These arguments prevent the view being zoomed in or</span>
<span class="sd">        out too far.</span>
<span class="sd">        </span>
<span class="sd">        =========== ============================================================</span>
<span class="sd">        minXRange   Minimum allowed left-to-right span across the view.</span>
<span class="sd">        maxXRange   Maximum allowed left-to-right span across the view.</span>
<span class="sd">        minYRange   Minimum allowed top-to-bottom span across the view.</span>
<span class="sd">        maxYRange   Maximum allowed top-to-bottom span across the view.</span>
<span class="sd">        =========== ============================================================</span>
<span class="sd">        </span>
<span class="sd">        Added in version 0.9.9</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">update</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">allowed</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xMin&#39;</span><span class="p">,</span> <span class="s1">&#39;xMax&#39;</span><span class="p">,</span> <span class="s1">&#39;yMin&#39;</span><span class="p">,</span> <span class="s1">&#39;yMax&#39;</span><span class="p">,</span> <span class="s1">&#39;minXRange&#39;</span><span class="p">,</span> <span class="s1">&#39;maxXRange&#39;</span><span class="p">,</span> <span class="s1">&#39;minYRange&#39;</span><span class="p">,</span> <span class="s1">&#39;maxYRange&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">kwd</span> <span class="ow">in</span> <span class="n">kwds</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kwd</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid keyword argument &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="n">kwd</span><span class="p">)</span>
        <span class="c1">#for kwd in [&#39;xLimits&#39;, &#39;yLimits&#39;, &#39;minRange&#39;, &#39;maxRange&#39;]:</span>
            <span class="c1">#if kwd in kwds and self.state[&#39;limits&#39;][kwd] != kwds[kwd]:</span>
                <span class="c1">#self.state[&#39;limits&#39;][kwd] = kwds[kwd]</span>
                <span class="c1">#update = True</span>
        <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">mnmx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">kwd</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;xMin&#39;</span><span class="p">,</span> <span class="s1">&#39;xMax&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;yMin&#39;</span><span class="p">,</span> <span class="s1">&#39;yMax&#39;</span><span class="p">]][</span><span class="n">axis</span><span class="p">][</span><span class="n">mnmx</span><span class="p">]</span>
                <span class="n">lname</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xLimits&#39;</span><span class="p">,</span> <span class="s1">&#39;yLimits&#39;</span><span class="p">][</span><span class="n">axis</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">kwd</span> <span class="ow">in</span> <span class="n">kwds</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;limits&#39;</span><span class="p">][</span><span class="n">lname</span><span class="p">][</span><span class="n">mnmx</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kwds</span><span class="p">[</span><span class="n">kwd</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;limits&#39;</span><span class="p">][</span><span class="n">lname</span><span class="p">][</span><span class="n">mnmx</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="n">kwd</span><span class="p">]</span>
                    <span class="n">update</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">kwd</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;minXRange&#39;</span><span class="p">,</span> <span class="s1">&#39;maxXRange&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;minYRange&#39;</span><span class="p">,</span> <span class="s1">&#39;maxYRange&#39;</span><span class="p">]][</span><span class="n">axis</span><span class="p">][</span><span class="n">mnmx</span><span class="p">]</span>
                <span class="n">lname</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xRange&#39;</span><span class="p">,</span> <span class="s1">&#39;yRange&#39;</span><span class="p">][</span><span class="n">axis</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">kwd</span> <span class="ow">in</span> <span class="n">kwds</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;limits&#39;</span><span class="p">][</span><span class="n">lname</span><span class="p">][</span><span class="n">mnmx</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kwds</span><span class="p">[</span><span class="n">kwd</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;limits&#39;</span><span class="p">][</span><span class="n">lname</span><span class="p">][</span><span class="n">mnmx</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="n">kwd</span><span class="p">]</span>
                    <span class="n">update</span> <span class="o">=</span> <span class="kc">True</span>
                    
        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateViewRange</span><span class="p">()</span></div>
                    
            
            
            
<div class="viewcode-block" id="ViewBox.scaleBy"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.scaleBy">[docs]</a>    <span class="k">def</span> <span class="nf">scaleBy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scale by *s* around given center point (or center of view).</span>
<span class="sd">        *s* may be a Point or tuple (x, y).</span>
<span class="sd">        </span>
<span class="sd">        Optionally, x or y may be specified individually. This allows the other </span>
<span class="sd">        axis to be left unaffected (note that using a scale factor of 1.0 may</span>
<span class="sd">        cause slight changes due to floating-point error).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
        
        <span class="n">affect</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scale</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="n">scale</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">affect</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">scale</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">elif</span> <span class="n">scale</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">affect</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">scale</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
            
        <span class="n">scale</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;aspectLocked&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">scale</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">scale</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">vr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">targetRect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">center</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">center</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">center</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">center</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>
        
        <span class="n">tl</span> <span class="o">=</span> <span class="n">center</span> <span class="o">+</span> <span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">topLeft</span><span class="p">()</span><span class="o">-</span><span class="n">center</span><span class="p">)</span> <span class="o">*</span> <span class="n">scale</span>
        <span class="n">br</span> <span class="o">=</span> <span class="n">center</span> <span class="o">+</span> <span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">bottomRight</span><span class="p">()</span><span class="o">-</span><span class="n">center</span><span class="p">)</span> <span class="o">*</span> <span class="n">scale</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">affect</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setYRange</span><span class="p">(</span><span class="n">tl</span><span class="o">.</span><span class="n">y</span><span class="p">(),</span> <span class="n">br</span><span class="o">.</span><span class="n">y</span><span class="p">(),</span> <span class="n">padding</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">affect</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setXRange</span><span class="p">(</span><span class="n">tl</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">br</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">padding</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="n">tl</span><span class="p">,</span> <span class="n">br</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="ViewBox.translateBy"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.translateBy">[docs]</a>    <span class="k">def</span> <span class="nf">translateBy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translate the view by *t*, which may be a Point or tuple (x, y).</span>
<span class="sd">        </span>
<span class="sd">        Alternately, x or y may be specified independently, leaving the other</span>
<span class="sd">        axis unchanged (note that using a translation of 0 may still cause</span>
<span class="sd">        small changes due to floating-point error).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">targetRect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">translated</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">vr</span><span class="o">.</span><span class="n">left</span><span class="p">()</span><span class="o">+</span><span class="n">x</span><span class="p">,</span> <span class="n">vr</span><span class="o">.</span><span class="n">right</span><span class="p">()</span><span class="o">+</span><span class="n">x</span>
            <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">vr</span><span class="o">.</span><span class="n">top</span><span class="p">()</span><span class="o">+</span><span class="n">y</span><span class="p">,</span> <span class="n">vr</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span><span class="o">+</span><span class="n">y</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="n">xRange</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">yRange</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>
            
        
        
<div class="viewcode-block" id="ViewBox.enableAutoRange"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.enableAutoRange">[docs]</a>    <span class="k">def</span> <span class="nf">enableAutoRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enable (or disable) auto-range for *axis*, which may be ViewBox.XAxis, ViewBox.YAxis, or ViewBox.XYAxes for both</span>
<span class="sd">        (if *axis* is omitted, both axes will be changed).</span>
<span class="sd">        When enabled, the axis will automatically rescale when items are added/removed or change their shape.</span>
<span class="sd">        The argument *enable* may optionally be a float (0.0-1.0) which indicates the fraction of the data that should</span>
<span class="sd">        be visible (this only works with items implementing a dataRange method, such as PlotDataItem).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#print &quot;autorange:&quot;, axis, enable</span>
        <span class="c1">#if not enable:</span>
            <span class="c1">#import traceback</span>
            <span class="c1">#traceback.print_stack()</span>
        
        <span class="c1"># support simpler interface:</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">enableAutoRange</span><span class="p">(</span><span class="n">ViewBox</span><span class="o">.</span><span class="n">XAxis</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">enableAutoRange</span><span class="p">(</span><span class="n">ViewBox</span><span class="o">.</span><span class="n">YAxis</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="k">if</span> <span class="n">enable</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">enable</span> <span class="o">=</span> <span class="mf">1.0</span>
        
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">XYAxes</span>
        
        <span class="n">needAutoRangeUpdate</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">XYAxes</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;xy&#39;</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">XAxis</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">YAxis</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;axis argument must be ViewBox.XAxis, ViewBox.YAxis, or ViewBox.XYAxes.&#39;</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoRange&#39;</span><span class="p">][</span><span class="n">ax</span><span class="p">]</span> <span class="o">!=</span> <span class="n">enable</span><span class="p">:</span>
                <span class="c1"># If we are disabling, do one last auto-range to make sure that</span>
                <span class="c1"># previously scheduled auto-range changes are enacted</span>
                <span class="k">if</span> <span class="n">enable</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_autoRangeNeedsUpdate</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">updateAutoRange</span><span class="p">()</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoRange&#39;</span><span class="p">][</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">enable</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_autoRangeNeedsUpdate</span> <span class="o">|=</span> <span class="p">(</span><span class="n">enable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>


        <span class="c1">#if needAutoRangeUpdate:</span>
        <span class="c1">#    self.updateAutoRange()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">sigStateChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewBox.disableAutoRange"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.disableAutoRange">[docs]</a>    <span class="k">def</span> <span class="nf">disableAutoRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Disables auto-range. (See enableAutoRange)&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enableAutoRange</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">enable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewBox.autoRangeEnabled"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.autoRangeEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">autoRangeEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoRange&#39;</span><span class="p">][:]</span></div>

<div class="viewcode-block" id="ViewBox.setAutoPan"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.setAutoPan">[docs]</a>    <span class="k">def</span> <span class="nf">setAutoPan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoPan&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoPan&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
        <span class="k">if</span> <span class="kc">None</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateAutoRange</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewBox.setAutoVisible"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.setAutoVisible">[docs]</a>    <span class="k">def</span> <span class="nf">setAutoVisible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoVisibleOnly&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoVisibleOnly&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoVisibleOnly&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
            <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoVisibleOnly&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateAutoRange</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewBox.updateAutoRange"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.updateAutoRange">[docs]</a>    <span class="k">def</span> <span class="nf">updateAutoRange</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">## Break recursive loops when auto-ranging.</span>
        <span class="c1">## This is needed because some items change their size in response </span>
        <span class="c1">## to a view change.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_updatingRange</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_updatingRange</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">targetRect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewRange</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoRange&#39;</span><span class="p">]):</span>
                <span class="k">return</span>
                
            <span class="n">fractionVisible</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoRange&#39;</span><span class="p">][:]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">fractionVisible</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">bool</span><span class="p">:</span>
                    <span class="n">fractionVisible</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>

            <span class="n">childRange</span> <span class="o">=</span> <span class="kc">None</span>
            
            <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoVisibleOnly&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoRange&#39;</span><span class="p">][</span><span class="n">ax</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoVisibleOnly&#39;</span><span class="p">][</span><span class="n">ax</span><span class="p">]:</span>
                    <span class="n">oRange</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
                    <span class="n">oRange</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">targetRect</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">ax</span><span class="p">]</span>
                    <span class="n">childRange</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">childrenBounds</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="n">fractionVisible</span><span class="p">,</span> <span class="n">orthoRange</span><span class="o">=</span><span class="n">oRange</span><span class="p">)</span>
                    
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">childRange</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">childRange</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">childrenBounds</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="n">fractionVisible</span><span class="p">)</span>
                
                <span class="c1">## Make corrections to range</span>
                <span class="n">xr</span> <span class="o">=</span> <span class="n">childRange</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">xr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoPan&#39;</span><span class="p">][</span><span class="n">ax</span><span class="p">]:</span>
                        <span class="n">x</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">xr</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
                        <span class="n">w2</span> <span class="o">=</span> <span class="p">(</span><span class="n">targetRect</span><span class="p">[</span><span class="n">ax</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">targetRect</span><span class="p">[</span><span class="n">ax</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.</span>
                        <span class="n">childRange</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="n">w2</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">w2</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">padding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">suggestPadding</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
                        <span class="n">wp</span> <span class="o">=</span> <span class="p">(</span><span class="n">xr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">padding</span>
                        <span class="n">childRange</span><span class="p">[</span><span class="n">ax</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">wp</span>
                        <span class="n">childRange</span><span class="p">[</span><span class="n">ax</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">wp</span>
                    <span class="n">targetRect</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="o">=</span> <span class="n">childRange</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span>
                    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;xRange&#39;</span> <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;yRange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">targetRect</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;padding&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;disableAutoRange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            
             <span class="c1"># check for and ignore bad ranges</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;xRange&#39;</span><span class="p">,</span> <span class="s1">&#39;yRange&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">k</span><span class="p">])):</span>
                        <span class="n">r</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                        <span class="c1">#print(&quot;Warning: %s is invalid: %s&quot; % (k, str(r))</span>
                        
            <span class="bp">self</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_autoRangeNeedsUpdate</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_updatingRange</span> <span class="o">=</span> <span class="kc">False</span></div>
        
<div class="viewcode-block" id="ViewBox.setXLink"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.setXLink">[docs]</a>    <span class="k">def</span> <span class="nf">setXLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Link this view&#39;s X axis to another view. (see LinkView)&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linkView</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XAxis</span><span class="p">,</span> <span class="n">view</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="ViewBox.setYLink"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.setYLink">[docs]</a>    <span class="k">def</span> <span class="nf">setYLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Link this view&#39;s Y axis to another view. (see LinkView)&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linkView</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">YAxis</span><span class="p">,</span> <span class="n">view</span><span class="p">)</span></div>
        
        
<div class="viewcode-block" id="ViewBox.linkView"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.linkView">[docs]</a>    <span class="k">def</span> <span class="nf">linkView</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Link X or Y axes of two views and unlink any previously connected axes. *axis* must be ViewBox.XAxis or ViewBox.YAxis.</span>
<span class="sd">        If view is None, the axis is left unlinked.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">view</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">view</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">view</span> <span class="o">=</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">NamedViews</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">view</span><span class="p">)</span>  <span class="c1">## convert view name to ViewBox if possible</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="s1">&#39;implements&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">view</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="s1">&#39;ViewBoxWrapper&#39;</span><span class="p">):</span>
            <span class="n">view</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">getViewBox</span><span class="p">()</span>

        <span class="c1">## used to connect/disconnect signals between a pair of views</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">XAxis</span><span class="p">:</span>
            <span class="n">signal</span> <span class="o">=</span> <span class="s1">&#39;sigXRangeChanged&#39;</span>
            <span class="n">slot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linkedXChanged</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">signal</span> <span class="o">=</span> <span class="s1">&#39;sigYRangeChanged&#39;</span>
            <span class="n">slot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linkedYChanged</span>


        <span class="n">oldLink</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linkedView</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">oldLink</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">oldLink</span><span class="p">,</span> <span class="n">signal</span><span class="p">)</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span>
                <span class="n">oldLink</span><span class="o">.</span><span class="n">sigResized</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">RuntimeError</span><span class="p">):</span>
                <span class="c1">## This can occur if the view has been deleted already</span>
                <span class="k">pass</span>
            
        
        <span class="k">if</span> <span class="n">view</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;linkedViews&#39;</span><span class="p">][</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">view</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;linkedViews&#39;</span><span class="p">][</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">signal</span><span class="p">)</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span>
            <span class="n">view</span><span class="o">.</span><span class="n">sigResized</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">view</span><span class="o">.</span><span class="n">autoRangeEnabled</span><span class="p">()[</span><span class="n">axis</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">enableAutoRange</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="n">slot</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">autoRangeEnabled</span><span class="p">()[</span><span class="n">axis</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">slot</span><span class="p">()</span>
        
            
        <span class="bp">self</span><span class="o">.</span><span class="n">sigStateChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="ViewBox.blockLink"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.blockLink">[docs]</a>    <span class="k">def</span> <span class="nf">blockLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linksBlocked</span> <span class="o">=</span> <span class="n">b</span>  <span class="c1">## prevents recursive plot-change propagation</span></div>

<div class="viewcode-block" id="ViewBox.linkedXChanged"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.linkedXChanged">[docs]</a>    <span class="k">def</span> <span class="nf">linkedXChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">## called when x range of linked view has changed</span>
        <span class="n">view</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linkedView</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linkedViewChanged</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">XAxis</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewBox.linkedYChanged"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.linkedYChanged">[docs]</a>    <span class="k">def</span> <span class="nf">linkedYChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">## called when y range of linked view has changed</span>
        <span class="n">view</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linkedView</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linkedViewChanged</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">YAxis</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="ViewBox.linkedView"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.linkedView">[docs]</a>    <span class="k">def</span> <span class="nf">linkedView</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
        <span class="c1">## Return the linked view for axis *ax*.</span>
        <span class="c1">## this method _always_ returns either a ViewBox or None.</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;linkedViews&#39;</span><span class="p">][</span><span class="n">ax</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span><span class="p">()</span>  <span class="c1">## dereference weakref pointer. If the reference is dead, this returns None</span></div>

<div class="viewcode-block" id="ViewBox.linkedViewChanged"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.linkedViewChanged">[docs]</a>    <span class="k">def</span> <span class="nf">linkedViewChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">linksBlocked</span> <span class="ow">or</span> <span class="n">view</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="c1">#print self.name, &quot;ViewBox.linkedViewChanged&quot;, axis, view.viewRange()[axis]</span>
        <span class="n">vr</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">viewRect</span><span class="p">()</span>
        <span class="n">vg</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">screenGeometry</span><span class="p">()</span>
        <span class="n">sg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenGeometry</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">vg</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">sg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="n">view</span><span class="o">.</span><span class="n">blockLink</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">XAxis</span><span class="p">:</span>
                <span class="n">overlap</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">sg</span><span class="o">.</span><span class="n">right</span><span class="p">(),</span> <span class="n">vg</span><span class="o">.</span><span class="n">right</span><span class="p">())</span> <span class="o">-</span> <span class="nb">max</span><span class="p">(</span><span class="n">sg</span><span class="o">.</span><span class="n">left</span><span class="p">(),</span> <span class="n">vg</span><span class="o">.</span><span class="n">left</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">overlap</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">vg</span><span class="o">.</span><span class="n">width</span><span class="p">()</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">sg</span><span class="o">.</span><span class="n">width</span><span class="p">()</span><span class="o">/</span><span class="mi">3</span><span class="p">):</span>  <span class="c1">## if less than 1/3 of views overlap, </span>
                                                               <span class="c1">## then just replicate the view</span>
                    <span class="n">x1</span> <span class="o">=</span> <span class="n">vr</span><span class="o">.</span><span class="n">left</span><span class="p">()</span>
                    <span class="n">x2</span> <span class="o">=</span> <span class="n">vr</span><span class="o">.</span><span class="n">right</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1">## views overlap; line them up</span>
                    <span class="n">upp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">width</span><span class="p">())</span> <span class="o">/</span> <span class="n">vg</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xInverted</span><span class="p">():</span>
                        <span class="n">x1</span> <span class="o">=</span> <span class="n">vr</span><span class="o">.</span><span class="n">left</span><span class="p">()</span>   <span class="o">+</span> <span class="p">(</span><span class="n">sg</span><span class="o">.</span><span class="n">right</span><span class="p">()</span><span class="o">-</span><span class="n">vg</span><span class="o">.</span><span class="n">right</span><span class="p">())</span> <span class="o">*</span> <span class="n">upp</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">x1</span> <span class="o">=</span> <span class="n">vr</span><span class="o">.</span><span class="n">left</span><span class="p">()</span>   <span class="o">+</span> <span class="p">(</span><span class="n">sg</span><span class="o">.</span><span class="n">x</span><span class="p">()</span><span class="o">-</span><span class="n">vg</span><span class="o">.</span><span class="n">x</span><span class="p">())</span> <span class="o">*</span> <span class="n">upp</span>
                    <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">sg</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">*</span> <span class="n">upp</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">enableAutoRange</span><span class="p">(</span><span class="n">ViewBox</span><span class="o">.</span><span class="n">XAxis</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setXRange</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">overlap</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">sg</span><span class="o">.</span><span class="n">bottom</span><span class="p">(),</span> <span class="n">vg</span><span class="o">.</span><span class="n">bottom</span><span class="p">())</span> <span class="o">-</span> <span class="nb">max</span><span class="p">(</span><span class="n">sg</span><span class="o">.</span><span class="n">top</span><span class="p">(),</span> <span class="n">vg</span><span class="o">.</span><span class="n">top</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">overlap</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">vg</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">sg</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">/</span><span class="mi">3</span><span class="p">):</span>  <span class="c1">## if less than 1/3 of views overlap, </span>
                                                                 <span class="c1">## then just replicate the view</span>
                    <span class="n">y1</span> <span class="o">=</span> <span class="n">vr</span><span class="o">.</span><span class="n">top</span><span class="p">()</span>
                    <span class="n">y2</span> <span class="o">=</span> <span class="n">vr</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1">## views overlap; line them up</span>
                    <span class="n">upp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">height</span><span class="p">())</span> <span class="o">/</span> <span class="n">vg</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">yInverted</span><span class="p">():</span>
                        <span class="n">y2</span> <span class="o">=</span> <span class="n">vr</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="n">sg</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span><span class="o">-</span><span class="n">vg</span><span class="o">.</span><span class="n">bottom</span><span class="p">())</span> <span class="o">*</span> <span class="n">upp</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">y2</span> <span class="o">=</span> <span class="n">vr</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="n">sg</span><span class="o">.</span><span class="n">top</span><span class="p">()</span><span class="o">-</span><span class="n">vg</span><span class="o">.</span><span class="n">top</span><span class="p">())</span> <span class="o">*</span> <span class="n">upp</span>
                    <span class="n">y1</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">sg</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">*</span> <span class="n">upp</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">enableAutoRange</span><span class="p">(</span><span class="n">ViewBox</span><span class="o">.</span><span class="n">YAxis</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setYRange</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">view</span><span class="o">.</span><span class="n">blockLink</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>
        
        
<div class="viewcode-block" id="ViewBox.screenGeometry"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.screenGeometry">[docs]</a>    <span class="k">def</span> <span class="nf">screenGeometry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return the screen geometry of the viewbox&quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getViewWidget</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sceneBoundingRect</span><span class="p">()</span>
        <span class="n">wr</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">mapFromScene</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">mapToGlobal</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>
        <span class="n">wr</span><span class="o">.</span><span class="n">adjust</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="p">(),</span> <span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">wr</span></div>
        
    

<div class="viewcode-block" id="ViewBox.itemsChanged"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.itemsChanged">[docs]</a>    <span class="k">def</span> <span class="nf">itemsChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">## called when items are added/removed from self.childGroup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateAutoRange</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="ViewBox.itemBoundsChanged"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.itemBoundsChanged">[docs]</a>    <span class="k">def</span> <span class="nf">itemBoundsChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_itemBoundsCache</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoRange&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;autoRange&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_autoRangeNeedsUpdate</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>
        <span class="c1">#self.updateAutoRange()</span>

<div class="viewcode-block" id="ViewBox.invertY"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.invertY">[docs]</a>    <span class="k">def</span> <span class="nf">invertY</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        By default, the positive y-axis points upward on the screen. Use invertY(True) to reverse the y-axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;yInverted&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;yInverted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matrixNeedsUpdate</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># updateViewRange won&#39;t detect this for us</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateViewRange</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigStateChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigYRangeChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span></div>

<div class="viewcode-block" id="ViewBox.yInverted"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.yInverted">[docs]</a>    <span class="k">def</span> <span class="nf">yInverted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;yInverted&#39;</span><span class="p">]</span></div>
        
<div class="viewcode-block" id="ViewBox.invertX"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.invertX">[docs]</a>    <span class="k">def</span> <span class="nf">invertX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        By default, the positive x-axis points rightward on the screen. Use invertX(True) to reverse the x-axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;xInverted&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;xInverted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span>
        <span class="c1">#self.updateMatrix(changed=(False, True))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateViewRange</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigStateChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigXRangeChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span></div>

<div class="viewcode-block" id="ViewBox.xInverted"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.xInverted">[docs]</a>    <span class="k">def</span> <span class="nf">xInverted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;xInverted&#39;</span><span class="p">]</span></div>
        
<div class="viewcode-block" id="ViewBox.setAspectLocked"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.setAspectLocked">[docs]</a>    <span class="k">def</span> <span class="nf">setAspectLocked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lock</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If the aspect ratio is locked, view scaling must always preserve the aspect ratio.</span>
<span class="sd">        By default, the ratio is set to 1; x and y both have the same scaling.</span>
<span class="sd">        This ratio can be overridden (xScale/yScale), or use None to lock in the current ratio.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;aspectLocked&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;aspectLocked&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">()</span>
            <span class="n">vr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewRect</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">vr</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">vr</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">currentRatio</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">currentRatio</span> <span class="o">=</span> <span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()))</span> <span class="o">/</span> <span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">width</span><span class="p">()</span><span class="o">/</span><span class="n">vr</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">ratio</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ratio</span> <span class="o">=</span> <span class="n">currentRatio</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;aspectLocked&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ratio</span><span class="p">:</span> <span class="c1"># nothing to change</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;aspectLocked&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratio</span>
            <span class="k">if</span> <span class="n">ratio</span> <span class="o">!=</span> <span class="n">currentRatio</span><span class="p">:</span>  <span class="c1">## If this would change the current range, do that now</span>
                <span class="c1">#self.setRange(0, self.state[&#39;viewRange&#39;][0][0], self.state[&#39;viewRange&#39;][0][1])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">updateViewRange</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">updateAutoRange</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateViewRange</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigStateChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="ViewBox.childTransform"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.childTransform">[docs]</a>    <span class="k">def</span> <span class="nf">childTransform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the transform that maps from child(item in the childGroup) coordinates to local coordinates.</span>
<span class="sd">        (This maps from inside the viewbox to outside)</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrixNeedsUpdate</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateMatrix</span><span class="p">()</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span><span class="o">.</span><span class="n">transform</span><span class="p">()</span>
        <span class="c1">#m1 = QtGui.QTransform()</span>
        <span class="c1">#m1.translate(self.childGroup.pos().x(), self.childGroup.pos().y())</span>
        <span class="k">return</span> <span class="n">m</span> <span class="c1">#*m1</span></div>

<div class="viewcode-block" id="ViewBox.mapToView"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.mapToView">[docs]</a>    <span class="k">def</span> <span class="nf">mapToView</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Maps from the local coordinates of the ViewBox to the coordinate system displayed inside the ViewBox&quot;&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">invertQTransform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childTransform</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewBox.mapFromView"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.mapFromView">[docs]</a>    <span class="k">def</span> <span class="nf">mapFromView</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Maps from the coordinate system displayed inside the ViewBox to the local coordinates of the ViewBox&quot;&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">childTransform</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewBox.mapSceneToView"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.mapSceneToView">[docs]</a>    <span class="k">def</span> <span class="nf">mapSceneToView</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Maps from scene coordinates to the coordinate system displayed inside the ViewBox&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapToView</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapFromScene</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span></div>

<div class="viewcode-block" id="ViewBox.mapViewToScene"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.mapViewToScene">[docs]</a>    <span class="k">def</span> <span class="nf">mapViewToScene</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Maps from the coordinate system displayed inside the ViewBox to scene coordinates&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapToScene</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapFromView</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span></div>
    
<div class="viewcode-block" id="ViewBox.mapFromItemToView"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.mapFromItemToView">[docs]</a>    <span class="k">def</span> <span class="nf">mapFromItemToView</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Maps *obj* from the local coordinate system of *item* to the view coordinates&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span><span class="o">.</span><span class="n">mapFromItem</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span></div>
        <span class="c1">#return self.mapSceneToView(item.mapToScene(obj))</span>

<div class="viewcode-block" id="ViewBox.mapFromViewToItem"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.mapFromViewToItem">[docs]</a>    <span class="k">def</span> <span class="nf">mapFromViewToItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Maps *obj* from view coordinates to the local coordinate system of *item*.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span><span class="o">.</span><span class="n">mapToItem</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span></div>
        <span class="c1">#return item.mapFromScene(self.mapViewToScene(obj))</span>

<div class="viewcode-block" id="ViewBox.mapViewToDevice"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.mapViewToDevice">[docs]</a>    <span class="k">def</span> <span class="nf">mapViewToDevice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapToDevice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapFromView</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span></div>
        
<div class="viewcode-block" id="ViewBox.mapDeviceToView"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.mapDeviceToView">[docs]</a>    <span class="k">def</span> <span class="nf">mapDeviceToView</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapToView</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapFromDevice</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span></div>
        
<div class="viewcode-block" id="ViewBox.viewPixelSize"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.viewPixelSize">[docs]</a>    <span class="k">def</span> <span class="nf">viewPixelSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the (width, height) of a screen pixel in view coordinates.&quot;&quot;&quot;</span>
        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapToView</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">px</span><span class="p">,</span> <span class="n">py</span> <span class="o">=</span> <span class="p">[</span><span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapToView</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">-</span> <span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixelVectors</span><span class="p">()]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">px</span><span class="o">.</span><span class="n">length</span><span class="p">(),</span> <span class="n">py</span><span class="o">.</span><span class="n">length</span><span class="p">())</span></div>
        
        
<div class="viewcode-block" id="ViewBox.itemBoundingRect"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.itemBoundingRect">[docs]</a>    <span class="k">def</span> <span class="nf">itemBoundingRect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the bounding rect of the item in view coordinates&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapSceneToView</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">sceneBoundingRect</span><span class="p">())</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span></div>
    
    <span class="c1">#def viewScale(self):</span>
        <span class="c1">#vr = self.viewRect()</span>
        <span class="c1">##print &quot;viewScale:&quot;, self.range</span>
        <span class="c1">#xd = vr.width()</span>
        <span class="c1">#yd = vr.height()</span>
        <span class="c1">#if xd == 0 or yd == 0:</span>
            <span class="c1">#print &quot;Warning: 0 range in view:&quot;, xd, yd</span>
            <span class="c1">#return np.array([1,1])</span>
        
        <span class="c1">##cs = self.canvas().size()</span>
        <span class="c1">#cs = self.boundingRect()</span>
        <span class="c1">#scale = np.array([cs.width() / xd, cs.height() / yd])</span>
        <span class="c1">##print &quot;view scale:&quot;, scale</span>
        <span class="c1">#return scale</span>

<div class="viewcode-block" id="ViewBox.wheelEvent"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.wheelEvent">[docs]</a>    <span class="k">def</span> <span class="nf">wheelEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;mouseEnabled&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">axis</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">axis</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">mask</span><span class="p">):</span>
            <span class="n">mv</span> <span class="o">=</span> <span class="n">mask</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
            <span class="n">mask</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">mask</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">mv</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">((</span><span class="n">mask</span> <span class="o">*</span> <span class="mf">0.02</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">delta</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;wheelScaleFactor&#39;</span><span class="p">])</span> <span class="c1"># actual scaling factor</span>
        
        <span class="n">center</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">invertQTransform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span><span class="o">.</span><span class="n">transform</span><span class="p">())</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">pos</span><span class="p">()))</span>
        <span class="c1">#center = ev.pos()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_resetTarget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaleBy</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigRangeChangedManually</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;mouseEnabled&#39;</span><span class="p">])</span>
        <span class="n">ev</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span></div>

        
<div class="viewcode-block" id="ViewBox.mouseClickEvent"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.mouseClickEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mouseClickEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ev</span><span class="o">.</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">RightButton</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuEnabled</span><span class="p">():</span>
            <span class="n">ev</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">raiseContextMenu</span><span class="p">(</span><span class="n">ev</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewBox.raiseContextMenu"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.raiseContextMenu">[docs]</a>    <span class="k">def</span> <span class="nf">raiseContextMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">):</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMenu</span><span class="p">(</span><span class="n">ev</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addParentContextMenus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">menu</span><span class="p">,</span> <span class="n">ev</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">popup</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">screenPos</span><span class="p">()</span><span class="o">.</span><span class="n">toPoint</span><span class="p">())</span></div>

<div class="viewcode-block" id="ViewBox.getMenu"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.getMenu">[docs]</a>    <span class="k">def</span> <span class="nf">getMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">menu</span></div>

<div class="viewcode-block" id="ViewBox.getContextMenus"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.getContextMenus">[docs]</a>    <span class="k">def</span> <span class="nf">getContextMenus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">actions</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuEnabled</span><span class="p">()</span> <span class="k">else</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="ViewBox.mouseDragEvent"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.mouseDragEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mouseDragEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1">## if axis is specified, event will only affect that axis.</span>
        <span class="n">ev</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>  <span class="c1">## we accept all buttons</span>
        
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ev</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span>
        <span class="n">lastPos</span> <span class="o">=</span> <span class="n">ev</span><span class="o">.</span><span class="n">lastPos</span><span class="p">()</span>
        <span class="n">dif</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">-</span> <span class="n">lastPos</span>
        <span class="n">dif</span> <span class="o">=</span> <span class="n">dif</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1">## Ignore axes if mouse is disabled</span>
        <span class="n">mouseEnabled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;mouseEnabled&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">mouseEnabled</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1">## Scale or translate based on mouse button</span>
        <span class="k">if</span> <span class="n">ev</span><span class="o">.</span><span class="n">button</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span> <span class="o">|</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">MidButton</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;mouseMode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">RectMode</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ev</span><span class="o">.</span><span class="n">isFinish</span><span class="p">():</span>  <span class="c1">## This is the final move in the drag; change the view scale now</span>
                    <span class="c1">#print &quot;finish&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rbScaleBox</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
                    <span class="c1">#ax = QtCore.QRectF(Point(self.pressPos), Point(self.mousePos))</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">buttonDownPos</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">button</span><span class="p">())),</span> <span class="n">Point</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span><span class="o">.</span><span class="n">mapRectFromParent</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">showAxRect</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axHistoryPointer</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axHistory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axHistory</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">axHistoryPointer</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">ax</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1">## update shape of scale box</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">updateScaleBox</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">buttonDownPos</span><span class="p">(),</span> <span class="n">ev</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tr</span> <span class="o">=</span> <span class="n">dif</span><span class="o">*</span><span class="n">mask</span>
                <span class="n">tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapToView</span><span class="p">(</span><span class="n">tr</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapToView</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">x</span><span class="p">()</span> <span class="k">if</span> <span class="n">mask</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">y</span><span class="p">()</span> <span class="k">if</span> <span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">_resetTarget</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">translateBy</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sigRangeChangedManually</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;mouseEnabled&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">ev</span><span class="o">.</span><span class="n">button</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">RightButton</span><span class="p">:</span>
            <span class="c1">#print &quot;vb.rightDrag&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;aspectLocked&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">mask</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            
            <span class="n">dif</span> <span class="o">=</span> <span class="n">ev</span><span class="o">.</span><span class="n">screenPos</span><span class="p">()</span> <span class="o">-</span> <span class="n">ev</span><span class="o">.</span><span class="n">lastScreenPos</span><span class="p">()</span>
            <span class="n">dif</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dif</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">dif</span><span class="o">.</span><span class="n">y</span><span class="p">()])</span>
            <span class="n">dif</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">s</span> <span class="o">=</span> <span class="p">((</span><span class="n">mask</span> <span class="o">*</span> <span class="mf">0.02</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="n">dif</span>
            
            <span class="n">tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span><span class="o">.</span><span class="n">transform</span><span class="p">()</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">invertQTransform</span><span class="p">(</span><span class="n">tr</span><span class="p">)</span>
            
            <span class="n">x</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">mouseEnabled</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">mouseEnabled</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
            
            <span class="n">center</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">buttonDownPos</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">RightButton</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_resetTarget</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scaleBy</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sigRangeChangedManually</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;mouseEnabled&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="ViewBox.keyPressEvent"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.keyPressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">keyPressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This routine should capture key presses in the current view box.</span>
<span class="sd">        Key presses are used only when mouse mode is RectMode</span>
<span class="sd">        The following events are implemented:</span>
<span class="sd">        ctrl-A : zooms out to the default &quot;full&quot; view of the plot</span>
<span class="sd">        ctrl-+ : moves forward in the zooming stack (if it exists)</span>
<span class="sd">        ctrl-- : moves backward in the zooming stack (if it exists)</span>
<span class="sd">         </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#print ev.key()</span>
        <span class="c1">#print &#39;I intercepted a key press, but did not accept it&#39;</span>
        
        <span class="c1">## not implemented yet ?</span>
        <span class="c1">#self.keypress.sigkeyPressEvent.emit()</span>
        
        <span class="n">ev</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ev</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scaleHistory</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ev</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scaleHistory</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ev</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Backspace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scaleHistory</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axHistory</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ev</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewBox.scaleHistory"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.scaleHistory">[docs]</a>    <span class="k">def</span> <span class="nf">scaleHistory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axHistory</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">ptr</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axHistory</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axHistoryPointer</span><span class="o">+</span><span class="n">d</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ptr</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axHistoryPointer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axHistoryPointer</span> <span class="o">=</span> <span class="n">ptr</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showAxRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axHistory</span><span class="p">[</span><span class="n">ptr</span><span class="p">])</span></div>
            

<div class="viewcode-block" id="ViewBox.updateScaleBox"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.updateScaleBox">[docs]</a>    <span class="k">def</span> <span class="nf">updateScaleBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span><span class="o">.</span><span class="n">mapRectFromParent</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rbScaleBox</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">topLeft</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rbScaleBox</span><span class="o">.</span><span class="n">resetTransform</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rbScaleBox</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">r</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rbScaleBox</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewBox.showAxRect"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.showAxRect">[docs]</a>    <span class="k">def</span> <span class="nf">showAxRect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">normalized</span><span class="p">())</span> <span class="c1"># be sure w, h are correct coordinates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigRangeChangedManually</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;mouseEnabled&#39;</span><span class="p">])</span></div>

    <span class="c1">#def mouseRect(self):</span>
        <span class="c1">#vs = self.viewScale()</span>
        <span class="c1">#vr = self.state[&#39;viewRange&#39;]</span>
        <span class="c1">## Convert positions from screen (view) pixel coordinates to axis coordinates </span>
        <span class="c1">#ax = QtCore.QRectF(self.pressPos[0]/vs[0]+vr[0][0], -(self.pressPos[1]/vs[1]-vr[1][1]),</span>
            <span class="c1">#(self.mousePos[0]-self.pressPos[0])/vs[0], -(self.mousePos[1]-self.pressPos[1])/vs[1])</span>
        <span class="c1">#return(ax)</span>

<div class="viewcode-block" id="ViewBox.allChildren"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.allChildren">[docs]</a>    <span class="k">def</span> <span class="nf">allChildren</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a list of all children and grandchildren of this ViewBox&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span>
        
        <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">childItems</span><span class="p">():</span>
            <span class="n">children</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allChildren</span><span class="p">(</span><span class="n">ch</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">children</span></div>
        
        
    
<div class="viewcode-block" id="ViewBox.childrenBounds"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.childrenBounds">[docs]</a>    <span class="k">def</span> <span class="nf">childrenBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">orthoRange</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span> <span class="n">items</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the bounding range of all children.</span>
<span class="sd">        [[xmin, xmax], [ymin, ymax]]</span>
<span class="sd">        Values may be None if there are no specific bounds for an axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">profiler</span> <span class="o">=</span> <span class="n">debug</span><span class="o">.</span><span class="n">Profiler</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">addedItems</span>
        
        <span class="c1">## measure pixel dimensions in view box</span>
        <span class="n">px</span><span class="p">,</span> <span class="n">py</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">length</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span><span class="o">.</span><span class="n">pixelVectors</span><span class="p">()]</span>
        
        <span class="c1">## First collect all boundary information</span>
        <span class="n">itemBounds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">item</span><span class="o">.</span><span class="n">isVisible</span><span class="p">():</span>
                <span class="k">continue</span>
        
            <span class="n">useX</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">useY</span> <span class="o">=</span> <span class="kc">True</span>
            
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s1">&#39;dataBounds&#39;</span><span class="p">):</span>
                <span class="c1">#bounds = self._itemBoundsCache.get(item, None)</span>
                <span class="c1">#if bounds is None:</span>
                <span class="k">if</span> <span class="n">frac</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">frac</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
                <span class="n">xr</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">dataBounds</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="n">frac</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">orthoRange</span><span class="o">=</span><span class="n">orthoRange</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">yr</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">dataBounds</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="n">frac</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">orthoRange</span><span class="o">=</span><span class="n">orthoRange</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">pxPad</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s1">&#39;pixelPadding&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">item</span><span class="o">.</span><span class="n">pixelPadding</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">xr</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">xr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">xr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">xr</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">xr</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                    <span class="n">useX</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">xr</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">yr</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">yr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">yr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                    <span class="n">useY</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">yr</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

                <span class="n">bounds</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="n">xr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">yr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapFromItemToView</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>
                
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">([</span><span class="n">useX</span><span class="p">,</span> <span class="n">useY</span><span class="p">]):</span>
                    <span class="k">continue</span>
                
                <span class="c1">## If we are ignoring only one axis, we need to check for rotations</span>
                <span class="k">if</span> <span class="n">useX</span> <span class="o">!=</span> <span class="n">useY</span><span class="p">:</span>  <span class="c1">##   !=  means  xor</span>
                    <span class="n">ang</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">transformAngle</span><span class="p">())</span>
                    <span class="k">if</span> <span class="n">ang</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">ang</span> <span class="o">==</span> <span class="mi">180</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="k">elif</span> <span class="n">ang</span> <span class="o">==</span> <span class="mi">90</span> <span class="ow">or</span> <span class="n">ang</span> <span class="o">==</span> <span class="mi">270</span><span class="p">:</span>
                        <span class="n">useX</span><span class="p">,</span> <span class="n">useY</span> <span class="o">=</span> <span class="n">useY</span><span class="p">,</span> <span class="n">useX</span> 
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1">## Item is rotated at non-orthogonal angle, ignore bounds entirely.</span>
                        <span class="c1">## Not really sure what is the expected behavior in this case.</span>
                        <span class="k">continue</span>  <span class="c1">## need to check for item rotations and decide how best to apply this boundary. </span>
                
                
                <span class="n">itemBounds</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">bounds</span><span class="p">,</span> <span class="n">useX</span><span class="p">,</span> <span class="n">useY</span><span class="p">,</span> <span class="n">pxPad</span><span class="p">))</span>
                    <span class="c1">#self._itemBoundsCache[item] = (bounds, useX, useY)</span>
                <span class="c1">#else:</span>
                    <span class="c1">#bounds, useX, useY = bounds</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">item</span><span class="o">.</span><span class="n">ItemHasNoContents</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bounds</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>
                <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapFromItemToView</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>
                <span class="n">itemBounds</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">bounds</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        
        <span class="c1">#print itemBounds</span>
        
        <span class="c1">## determine tentative new range</span>
        <span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">useX</span><span class="p">,</span> <span class="n">useY</span><span class="p">,</span> <span class="n">px</span> <span class="ow">in</span> <span class="n">itemBounds</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">useY</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">top</span><span class="p">(),</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">bottom</span><span class="p">(),</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">bounds</span><span class="o">.</span><span class="n">top</span><span class="p">(),</span> <span class="n">bounds</span><span class="o">.</span><span class="n">bottom</span><span class="p">()]</span>
            <span class="k">if</span> <span class="n">useX</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">left</span><span class="p">(),</span> <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">right</span><span class="p">(),</span> <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">bounds</span><span class="o">.</span><span class="n">left</span><span class="p">(),</span> <span class="n">bounds</span><span class="o">.</span><span class="n">right</span><span class="p">()]</span>
            <span class="n">profiler</span><span class="p">()</span>
        
        <span class="c1">#print &quot;range&quot;, range</span>
        
        <span class="c1">## Now expand any bounds that have a pixel margin</span>
        <span class="c1">## This must be done _after_ we have a good estimate of the new range</span>
        <span class="c1">## to ensure that the pixel size is roughly accurate.</span>
        <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="c1">#print &quot;w:&quot;, w, &quot;h:&quot;, h</span>
        <span class="k">if</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pxSize</span> <span class="o">=</span> <span class="p">(</span><span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">w</span>
            <span class="k">for</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">useX</span><span class="p">,</span> <span class="n">useY</span><span class="p">,</span> <span class="n">px</span> <span class="ow">in</span> <span class="n">itemBounds</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">px</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">useX</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="o">.</span><span class="n">left</span><span class="p">()</span> <span class="o">-</span> <span class="n">px</span><span class="o">*</span><span class="n">pxSize</span><span class="p">)</span>
                <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="o">.</span><span class="n">right</span><span class="p">()</span> <span class="o">+</span> <span class="n">px</span><span class="o">*</span><span class="n">pxSize</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">h</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pxSize</span> <span class="o">=</span> <span class="p">(</span><span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span>
            <span class="k">for</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">useX</span><span class="p">,</span> <span class="n">useY</span><span class="p">,</span> <span class="n">px</span> <span class="ow">in</span> <span class="n">itemBounds</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">px</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">useY</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="o">.</span><span class="n">top</span><span class="p">()</span> <span class="o">-</span> <span class="n">px</span><span class="o">*</span><span class="n">pxSize</span><span class="p">)</span>
                <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span> <span class="o">+</span> <span class="n">px</span><span class="o">*</span><span class="n">pxSize</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">range</span></div>
        
<div class="viewcode-block" id="ViewBox.childrenBoundingRect"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.childrenBoundingRect">[docs]</a>    <span class="k">def</span> <span class="nf">childrenBoundingRect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="nb">range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">childrenBounds</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
        <span class="n">tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">targetRange</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            
        <span class="n">bounds</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">bounds</span></div>
            
<div class="viewcode-block" id="ViewBox.updateViewRange"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.updateViewRange">[docs]</a>    <span class="k">def</span> <span class="nf">updateViewRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">forceX</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">forceY</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1">## Update viewRange to match targetRange as closely as possible, given </span>
        <span class="c1">## aspect ratio constraints. The *force* arguments are used to indicate </span>
        <span class="c1">## which axis (if any) should be unchanged when applying constraints.</span>
        <span class="n">viewRange</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;targetRange&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;targetRange&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][:]]</span>
        <span class="n">changed</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
        
        <span class="c1">#-------- Make correction for aspect ratio constraint ----------</span>
        
        <span class="c1"># aspect is (widget w/h) / (view range w/h)</span>
        <span class="n">aspect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;aspectLocked&#39;</span><span class="p">]</span>  <span class="c1"># size ratio / view ratio</span>
        <span class="n">tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">targetRect</span><span class="p">()</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">aspect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span> <span class="ow">and</span> <span class="mi">0</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">aspect</span><span class="p">,</span> <span class="n">tr</span><span class="o">.</span><span class="n">height</span><span class="p">(),</span> <span class="n">bounds</span><span class="o">.</span><span class="n">height</span><span class="p">(),</span> <span class="n">bounds</span><span class="o">.</span><span class="n">width</span><span class="p">()]:</span>
            
            <span class="c1">## This is the view range aspect ratio we have requested</span>
            <span class="n">targetRatio</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">/</span> <span class="n">tr</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="c1">## This is the view range aspect ratio we need to obey aspect constraint</span>
            <span class="n">viewRatio</span> <span class="o">=</span> <span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">/</span> <span class="n">bounds</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="k">if</span> <span class="n">bounds</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">aspect</span>
            <span class="n">viewRatio</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">viewRatio</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">viewRatio</span>
            
            <span class="c1"># Decide which range to keep unchanged</span>
            <span class="c1">#print self.name, &quot;aspect:&quot;, aspect, &quot;changed:&quot;, changed, &quot;auto:&quot;, self.state[&#39;autoRange&#39;]</span>
            <span class="k">if</span> <span class="n">forceX</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">forceY</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># if we are not required to keep a particular axis unchanged, </span>
                <span class="c1"># then make the entire target range visible</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">targetRatio</span> <span class="o">&gt;</span> <span class="n">viewRatio</span> <span class="k">else</span> <span class="mi">1</span>
            
            <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  
                <span class="c1">## view range needs to be taller than target</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">/</span> <span class="n">viewRatio</span> <span class="o">-</span> <span class="n">tr</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">dy</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">changed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">viewRange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;targetRange&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;targetRange&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dy</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">## view range needs to be wider than target</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">*</span> <span class="n">viewRatio</span> <span class="o">-</span> <span class="n">tr</span><span class="o">.</span><span class="n">width</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">dx</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">changed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">viewRange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;targetRange&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;targetRange&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dx</span><span class="p">]</span>

            
        <span class="c1"># ----------- Make corrections for view limits -----------</span>
        
        <span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;limits&#39;</span><span class="p">][</span><span class="s1">&#39;xLimits&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;limits&#39;</span><span class="p">][</span><span class="s1">&#39;yLimits&#39;</span><span class="p">])</span>
        <span class="n">minRng</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;limits&#39;</span><span class="p">][</span><span class="s1">&#39;xRange&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;limits&#39;</span><span class="p">][</span><span class="s1">&#39;yRange&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">maxRng</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;limits&#39;</span><span class="p">][</span><span class="s1">&#39;xRange&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;limits&#39;</span><span class="p">][</span><span class="s1">&#39;yRange&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
        
        <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">limits</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">limits</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">minRng</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">maxRng</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            
            <span class="c1"># max range cannot be larger than bounds, if they are given</span>
            <span class="k">if</span> <span class="n">limits</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">limits</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">maxRng</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">maxRng</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">maxRng</span><span class="p">[</span><span class="n">axis</span><span class="p">],</span> <span class="n">limits</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">limits</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">maxRng</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">limits</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="c1">#print &quot;\nLimits for axis %d: range=%s min=%s max=%s&quot; % (axis, limits[axis], minRng[axis], maxRng[axis])</span>
            <span class="c1">#print &quot;Starting range:&quot;, viewRange[axis]</span>
            
            <span class="c1"># Apply xRange, yRange</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="n">viewRange</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">viewRange</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">maxRng</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="n">maxRng</span><span class="p">[</span><span class="n">axis</span><span class="p">]:</span>
                <span class="n">delta</span> <span class="o">=</span> <span class="n">maxRng</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">-</span> <span class="n">diff</span>
                <span class="n">changed</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">minRng</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">diff</span> <span class="o">&lt;</span> <span class="n">minRng</span><span class="p">[</span><span class="n">axis</span><span class="p">]:</span>
                <span class="n">delta</span> <span class="o">=</span> <span class="n">minRng</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">-</span> <span class="n">diff</span>
                <span class="n">changed</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span>
            
            <span class="n">viewRange</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">delta</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">viewRange</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">delta</span><span class="o">/</span><span class="mf">2.</span>
            
            <span class="c1">#print &quot;after applying min/max:&quot;, viewRange[axis]</span>
               
            <span class="c1"># Apply xLimits, yLimits</span>
            <span class="n">mn</span><span class="p">,</span> <span class="n">mx</span> <span class="o">=</span> <span class="n">limits</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">mn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">viewRange</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">mn</span><span class="p">:</span>
                <span class="n">delta</span> <span class="o">=</span> <span class="n">mn</span> <span class="o">-</span> <span class="n">viewRange</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">viewRange</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">delta</span>
                <span class="n">viewRange</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">delta</span>
                <span class="n">changed</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">mx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">viewRange</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">mx</span><span class="p">:</span>
                <span class="n">delta</span> <span class="o">=</span> <span class="n">mx</span> <span class="o">-</span> <span class="n">viewRange</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">viewRange</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">delta</span>
                <span class="n">viewRange</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">delta</span>
                <span class="n">changed</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            
            <span class="c1">#print &quot;after applying edge limits:&quot;, viewRange[axis]</span>

        <span class="n">changed</span> <span class="o">=</span> <span class="p">[(</span><span class="n">viewRange</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="n">viewRange</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">viewRange</span>
        
        <span class="c1"># emit range change signals</span>
        <span class="k">if</span> <span class="n">changed</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sigXRangeChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">changed</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sigYRangeChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
        
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">changed</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sigRangeChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;viewRange&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matrixNeedsUpdate</span> <span class="o">=</span> <span class="kc">True</span>
        
            <span class="c1"># Inform linked views that the range has changed</span>
            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">changed</span><span class="p">[</span><span class="n">ax</span><span class="p">]:</span>
                    <span class="k">continue</span>
                <span class="n">link</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linkedView</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">link</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">link</span><span class="o">.</span><span class="n">linkedViewChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="ViewBox.updateMatrix"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.updateMatrix">[docs]</a>    <span class="k">def</span> <span class="nf">updateMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">changed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1">## Make the childGroup&#39;s transform match the requested viewRange.</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">()</span>
        
        <span class="n">vr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewRect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">vr</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">vr</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">bounds</span><span class="o">.</span><span class="n">width</span><span class="p">()</span><span class="o">/</span><span class="n">vr</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">bounds</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">/</span><span class="n">vr</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;yInverted&#39;</span><span class="p">]:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span> <span class="o">*</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;xInverted&#39;</span><span class="p">]:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span> <span class="o">*</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QTransform</span><span class="p">()</span>
        
        <span class="c1">## First center the viewport at 0</span>
        <span class="n">center</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
        <span class="n">m</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">center</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">center</span><span class="o">.</span><span class="n">y</span><span class="p">())</span>
            
        <span class="c1">## Now scale and translate properly</span>
        <span class="n">m</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">scale</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">scale</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">center</span><span class="p">())</span>
        <span class="n">m</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">-</span><span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">st</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span><span class="o">.</span><span class="n">setTransform</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">sigTransformChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1">## segfaults here: 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matrixNeedsUpdate</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="ViewBox.paint"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkSceneChange</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">border</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">()</span>
            <span class="n">p</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">border</span><span class="p">)</span>
            <span class="c1">#p.fillRect(bounds, QtGui.QColor(0, 0, 0))</span>
            <span class="n">p</span><span class="o">.</span><span class="n">drawPath</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span></div>
            
        <span class="c1">#p.setPen(fn.mkPen(&#39;r&#39;))</span>
        <span class="c1">#path = QtGui.QPainterPath()</span>
        <span class="c1">#path.addRect(self.targetRect())</span>
        <span class="c1">#tr = self.mapFromView(path)</span>
        <span class="c1">#p.drawPath(tr)</span>

<div class="viewcode-block" id="ViewBox.updateBackground"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.updateBackground">[docs]</a>    <span class="k">def</span> <span class="nf">updateBackground</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">bg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">mkBrush</span><span class="p">(</span><span class="n">bg</span><span class="p">))</span></div>
            
            
<div class="viewcode-block" id="ViewBox.updateViewLists"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.updateViewLists">[docs]</a>    <span class="k">def</span> <span class="nf">updateViewLists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>  <span class="c1">## this view has already been deleted; it will probably be collected shortly.</span>
            <span class="k">return</span>
            
        <span class="k">def</span> <span class="nf">cmpViews</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
            <span class="n">wins</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">cmp</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">window</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">(),</span> <span class="n">b</span><span class="o">.</span><span class="n">window</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">())</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="nb">cmp</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">wins</span> <span class="o">+</span> <span class="n">alpha</span>
            
        <span class="c1">## make a sorted list of all named views</span>
        <span class="n">nv</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ViewBox</span><span class="o">.</span><span class="n">NamedViews</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="c1">#print &quot;new view list:&quot;, nv</span>
        <span class="n">sortList</span><span class="p">(</span><span class="n">nv</span><span class="p">,</span> <span class="n">cmpViews</span><span class="p">)</span> <span class="c1">## see pyqtgraph.python2_3.sortList</span>
        
        <span class="k">if</span> <span class="bp">self</span> <span class="ow">in</span> <span class="n">nv</span><span class="p">:</span>
            <span class="n">nv</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">setViewList</span><span class="p">(</span><span class="n">nv</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">link</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;linkedViews&#39;</span><span class="p">][</span><span class="n">ax</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>     <span class="c1">## axis has not been linked yet; see if it&#39;s possible now</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">nv</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">link</span> <span class="o">==</span> <span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">linkView</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span></div>
        <span class="c1">#print &quot;New view list:&quot;, nv</span>
        <span class="c1">#print &quot;linked views:&quot;, self.state[&#39;linkedViews&#39;]</span>

<div class="viewcode-block" id="ViewBox.updateAllViewLists"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.updateAllViewLists">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">updateAllViewLists</span><span class="p">():</span>
        <span class="c1">#print &quot;Update:&quot;, ViewBox.AllViews.keys()</span>
        <span class="c1">#print &quot;Update:&quot;, ViewBox.NamedViews.keys()</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">AllViews</span><span class="p">:</span>
            <span class="n">v</span><span class="o">.</span><span class="n">updateViewLists</span><span class="p">()</span></div>
            

<div class="viewcode-block" id="ViewBox.forgetView"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.forgetView">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">forgetView</span><span class="p">(</span><span class="n">vid</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ViewBox</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>     <span class="c1">## can happen as python is shutting down</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1">## Called with ID and name of view (the view itself is no longer available)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ViewBox</span><span class="o">.</span><span class="n">AllViews</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">id</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="n">vid</span><span class="p">:</span>
                <span class="n">ViewBox</span><span class="o">.</span><span class="n">AllViews</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="n">ViewBox</span><span class="o">.</span><span class="n">NamedViews</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">ViewBox</span><span class="o">.</span><span class="n">updateAllViewLists</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewBox.quit"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.quit">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">quit</span><span class="p">():</span>
        <span class="c1">## called when the application is about to exit.</span>
        <span class="c1">## this disables all callbacks, which might otherwise generate errors if invoked during exit.</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ViewBox</span><span class="o">.</span><span class="n">AllViews</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">isQObjectAlive</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="ow">and</span> <span class="n">getConfigOption</span><span class="p">(</span><span class="s1">&#39;crashWarning&#39;</span><span class="p">):</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Warning: ViewBox should be closed before application exit.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                
            <span class="k">try</span><span class="p">:</span>
                <span class="n">k</span><span class="o">.</span><span class="n">destroyed</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>  <span class="c1">## signal is already disconnected.</span>
                <span class="k">pass</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c1">## view has already been deleted (?)</span>
                <span class="k">pass</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># PySide has deleted signal</span>
                <span class="k">pass</span></div>
            
<div class="viewcode-block" id="ViewBox.locate"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.locate">[docs]</a>    <span class="k">def</span> <span class="nf">locate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Temporarily display the bounding rect of an item and lines connecting to the center of the view.</span>
<span class="sd">        This is useful for determining the location of items that may be out of the range of the ViewBox.</span>
<span class="sd">        if allChildren is True, then the bounding rect of all item&#39;s children will be shown instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearLocate</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Item does not share a scene with this ViewBox.&quot;</span><span class="p">)</span>
        
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewRect</span><span class="p">()</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">children</span><span class="p">:</span>
            <span class="n">br</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapFromItemToView</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">childrenBoundingRect</span><span class="p">())</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">br</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapFromItemToView</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">())</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>
        
        <span class="n">g</span> <span class="o">=</span> <span class="n">ItemGroup</span><span class="p">()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childGroup</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locateGroup</span> <span class="o">=</span> <span class="n">g</span>
        <span class="n">g</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="p">(</span><span class="n">br</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span><span class="n">br</span><span class="o">.</span><span class="n">topLeft</span><span class="p">(),</span> <span class="n">br</span><span class="o">.</span><span class="n">bottomLeft</span><span class="p">(),</span> <span class="n">br</span><span class="o">.</span><span class="n">bottomRight</span><span class="p">(),</span> <span class="n">br</span><span class="o">.</span><span class="n">topRight</span><span class="p">()):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">(),</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">())</span>
            <span class="n">line</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">g</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">childItems</span><span class="p">():</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">mkPen</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
        <span class="n">g</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">children</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsPathItem</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">childrenShape</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsPathItem</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">shape</span><span class="p">())</span>
        <span class="n">g</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">mkPen</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">))</span>
        <span class="n">g</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="n">timeout</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clearLocate</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="ViewBox.clearLocate"><a class="viewcode-back" href="../../../../../../../bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.html#bornagain.external.pyqtgraph.pyqtgraph.graphicsItems.ViewBox.ViewBox.ViewBox.clearLocate">[docs]</a>    <span class="k">def</span> <span class="nf">clearLocate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locateGroup</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locateGroup</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locateGroup</span> <span class="o">=</span> <span class="kc">None</span></div></div>

<span class="kn">from</span> <span class="nn">.ViewBoxMenu</span> <span class="k">import</span> <span class="n">ViewBoxMenu</span>
</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Richard A Kirian.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../../../../',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>