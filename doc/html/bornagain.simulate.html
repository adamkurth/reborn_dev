

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>bornagain.simulate package &mdash; bornagain 0.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="bornagain 0.0.1 documentation" href="index.html"/>
        <link rel="up" title="bornagain package" href="bornagain.html"/>
        <link rel="next" title="bornagain.target package" href="bornagain.target.html"/>
        <link rel="prev" title="bornagain.external.pyqtgraph package" href="bornagain.external.pyqtgraph.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> bornagain
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="bornagain.html">bornagain package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="bornagain.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="bornagain.external.html">bornagain.external package</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">bornagain.simulate package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-bornagain.simulate.atoms">bornagain.simulate.atoms module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-bornagain.simulate.clcore">bornagain.simulate.clcore module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-bornagain.simulate.examples">bornagain.simulate.examples module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-bornagain.simulate.refdata">bornagain.simulate.refdata module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-bornagain.simulate.simutils">bornagain.simulate.simutils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-bornagain.simulate.solutions">bornagain.simulate.solutions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-bornagain.simulate.thorn">bornagain.simulate.thorn module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-bornagain.simulate">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="bornagain.target.html">bornagain.target package</a></li>
<li class="toctree-l3"><a class="reference internal" href="bornagain.viewers.html">bornagain.viewers package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bornagain.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="bornagain.html#module-bornagain.detector">bornagain.detector module</a></li>
<li class="toctree-l2"><a class="reference internal" href="bornagain.html#module-bornagain.scatter">bornagain.scatter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="bornagain.html#module-bornagain.source">bornagain.source module</a></li>
<li class="toctree-l2"><a class="reference internal" href="bornagain.html#module-bornagain.units">bornagain.units module</a></li>
<li class="toctree-l2"><a class="reference internal" href="bornagain.html#module-bornagain.utils">bornagain.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="bornagain.html#module-bornagain">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">bornagain</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="bornagain.html">bornagain package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="bornagain.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="bornagain.external.html">bornagain.external package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">bornagain.simulate package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bornagain.target.html">bornagain.target package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bornagain.viewers.html">bornagain.viewers package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="bornagain.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="bornagain.html#module-bornagain.detector">bornagain.detector module</a></li>
<li class="toctree-l3"><a class="reference internal" href="bornagain.html#module-bornagain.scatter">bornagain.scatter module</a></li>
<li class="toctree-l3"><a class="reference internal" href="bornagain.html#module-bornagain.source">bornagain.source module</a></li>
<li class="toctree-l3"><a class="reference internal" href="bornagain.html#module-bornagain.units">bornagain.units module</a></li>
<li class="toctree-l3"><a class="reference internal" href="bornagain.html#module-bornagain.utils">bornagain.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="bornagain.html#module-bornagain">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="coding.html">Coding guidlines for developers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">bornagain</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="bornagain.html">bornagain package</a> &raquo;</li>
        
      <li>bornagain.simulate package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/bornagain.simulate.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="bornagain-simulate-package">
<h1>bornagain.simulate package<a class="headerlink" href="#bornagain-simulate-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-bornagain.simulate.atoms">
<span id="bornagain-simulate-atoms-module"></span><h2>bornagain.simulate.atoms module<a class="headerlink" href="#module-bornagain.simulate.atoms" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="bornagain.simulate.atoms.atomic_symbols_to_numbers">
<code class="descclassname">bornagain.simulate.atoms.</code><code class="descname">atomic_symbols_to_numbers</code><span class="sig-paren">(</span><em>symbols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/atoms.html#atomic_symbols_to_numbers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.atoms.atomic_symbols_to_numbers" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert atomic symbols (such as C, N, He, Be) to atomic numbers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>symbols</strong> (<em>string/list-like</em>) – Atomic symbol strings. Case insensitive.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Atomic numbers.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numbers (numpy array)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bornagain.simulate.atoms.atomic_numbers_to_symbols">
<code class="descclassname">bornagain.simulate.atoms.</code><code class="descname">atomic_numbers_to_symbols</code><span class="sig-paren">(</span><em>numbers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/atoms.html#atomic_numbers_to_symbols"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.atoms.atomic_numbers_to_symbols" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert atomic numbers to atomic symbols (such as C, N, He, Ca)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>numbers</strong> (<em>int/list-like</em>) – Atomic numbers</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Atomic element symbols (such as H, He, Be)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">symbols (numpy string array)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bornagain.simulate.atoms.get_henke_data">
<code class="descclassname">bornagain.simulate.atoms.</code><code class="descname">get_henke_data</code><span class="sig-paren">(</span><em>atomic_number</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/atoms.html#get_henke_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.atoms.get_henke_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load Henke scattering factor data from disk, cache for future retrieval. The
Henke data was gathered from the Center for X-Ray Optics web page at the
Lawrence Berkeley National Laboratory.  There is a publication with details
(reference to be added).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atomic_number</strong> (<em>int</em>) – You guessed it!</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>A dictionary with the following fields</dt>
<dd>’Atomic Number’ – Atomic number of the element
‘Element Symbol’ – Standard element symbol (e.g. He)
‘Photon Energy’ – A numpy array of photon energies (SI units)
‘Scatter Factor’ – A numpy array of complex atomic scattering factors that correspond to the photon
energies above.</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bornagain.simulate.atoms.get_scattering_factors">
<code class="descclassname">bornagain.simulate.atoms.</code><code class="descname">get_scattering_factors</code><span class="sig-paren">(</span><em>atomic_numbers</em>, <em>photon_energy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/atoms.html#get_scattering_factors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.atoms.get_scattering_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Get complex atomic scattering factors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atomic_numbers</strong> (<em>int/list-like</em>) – Atomic numbers.</li>
<li><strong>photon_energy</strong> (<em>float</em>) – Photon energy.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Complex scattering factors.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">scattering_factors (complex/numpy array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-bornagain.simulate.clcore">
<span id="bornagain-simulate-clcore-module"></span><h2>bornagain.simulate.clcore module<a class="headerlink" href="#module-bornagain.simulate.clcore" title="Permalink to this headline">¶</a></h2>
<p>This module contains some core functions that are useful for simulating
diffraction on GPU devices.  It is not finished yet…</p>
<p>Some environment variables that affect this module:
‘BORNAGAIN_CL_GROUPSIZE’ : This sets the default groupsize.  It will
otherwise be 32.  If you are using a CPU you might want to set
BORNAGAIN_CL_GROUPSIZE=1 .</p>
<dl class="class">
<dt id="bornagain.simulate.clcore.ClCore">
<em class="property">class </em><code class="descclassname">bornagain.simulate.clcore.</code><code class="descname">ClCore</code><span class="sig-paren">(</span><em>context=None</em>, <em>queue=None</em>, <em>group_size=None</em>, <em>double_precision=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.set_groupsize">
<code class="descname">set_groupsize</code><span class="sig-paren">(</span><em>group_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.set_groupsize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.set_groupsize" title="Permalink to this definition">¶</a></dt>
<dd><p>If the environment variable BORNAGAIN_CL_GROUPSIZE is set then use
that value.</p>
<p>If the group size exceeds the max allowed group size, then make it
smaller (but print warning)</p>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.vec4">
<code class="descname">vec4</code><span class="sig-paren">(</span><em>x</em>, <em>dtype=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.vec4"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.vec4" title="Permalink to this definition">¶</a></dt>
<dd><p>Evdidently pyopencl does not deal with 3-vectors very well, so we use
4-vectors and pad with a zero at the end.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong><strong>, </strong><strong>np.ndarray</strong> (<em>-</em>) – </li>
<li><strong>dtype</strong><strong>, </strong><strong>np.dtype</strong> (<em>-</em>) – default is np.float32</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>numpy array of length 4</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.vec16">
<code class="descname">vec16</code><span class="sig-paren">(</span><em>R</em>, <em>dtype=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.vec16"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.vec16" title="Permalink to this definition">¶</a></dt>
<dd><p>The best way to pass in a rotation matrix is as a float16.  This is a helper function for preparing a numpy
array so that it can be passed in as a float16.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>R</strong><strong>, </strong><strong>np.ndarray</strong> (<em>-</em>) – </li>
<li><strong>dtype</strong><strong>, </strong><strong>np.dtype</strong> (<em>-</em>) – default is np.float32</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>numpy array of length 16</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="bornagain.simulate.clcore.ClCore.to_device_static">
<em class="property">static </em><code class="descname">to_device_static</code><span class="sig-paren">(</span><em>dtype</em>, <em>queue</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.to_device_static"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.to_device_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method</p>
<p>This is a thin wrapper for pyopencl.array.to_device().  It will convert a numpy
array into a pyopencl.array and send it to the device memory.  So far this only
deals with float and comlex arrays, and it should figure out which type it is.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>numpy/cl array; float/complex type</em>) – Input array.</li>
<li><strong>dtype</strong> (<em>np.dtype</em>) – Specify the desired type in opencl.  The two types that
are useful here are np.float32 and np.complex64</li>
<li><strong>CL queue</strong> (<em>queue</em><em>,</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pyopencl array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.to_device">
<code class="descname">to_device</code><span class="sig-paren">(</span><em>array=None</em>, <em>shape=None</em>, <em>dtype=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.to_device"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.to_device" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a thin wrapper for pyopencl.array.to_device().  It will convert a numpy
array into a pyopencl.array and send it to the device memory.  So far this only
deals with float and comlex arrays, and it should figure out which type it is.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>numpy/cl array; float/complex type</em>) – Input array.</li>
<li><strong>shape</strong> (<em>tuple</em>) – Optionally specify the shape of the desired array.  This is
ignored if array is not None.</li>
<li><strong>dtype</strong> (<em>np.dtype</em>) – Specify the desired type in opencl.  The two types that
are useful here are np.float32 and np.complex64</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">pyopencl array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.get_group_size">
<code class="descname">get_group_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.get_group_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.get_group_size" title="Permalink to this definition">¶</a></dt>
<dd><p>retrieve the currently set group_size</p>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.mod_squared_complex_to_real">
<code class="descname">mod_squared_complex_to_real</code><span class="sig-paren">(</span><em>A</em>, <em>I</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.mod_squared_complex_to_real"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.mod_squared_complex_to_real" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the real-valued modulus square of complex numbers.
Good example of a function that shouldn’t exist, but I needed to add
it here because the pyopencl.array.Array class fails at this seemingly
simple task.</p>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.phase_factor_qrf_chunk">
<code class="descname">phase_factor_qrf_chunk</code><span class="sig-paren">(</span><em>q</em>, <em>r</em>, <em>f</em>, <em>Nchunk</em>, <em>q_is_qdev=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.phase_factor_qrf_chunk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.phase_factor_qrf_chunk" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate diffraction amplitudes: sum over f_n*exp(-iq.r_n)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>q</strong> (<em>numpy/cl float array</em><em> [</em><em>N</em><em>,</em><em>3</em><em>]</em>) – Scattering vectors (2pi/lambda).</li>
<li><strong>r</strong> (<em>numpy/cl float array</em><em> [</em><em>M</em><em>,</em><em>3</em><em>]</em>) – Atomic coordinates.</li>
<li><strong>f</strong> (<em>numpy/cl complex array</em><em> [</em><em>M</em><em>]</em>) – Complex scattering factors.</li>
<li><strong>number of chunks to split up atoms..</strong> (<em>Nchunk</em><em>,</em>) – </li>
<li><strong>a</strong> (<em>cl complex array</em><em> [</em><em>N</em><em>]</em>) – Optional container for complex scattering
amplitudes.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>Diffraction amplitudes.  Will be a cl array</dt>
<dd><p class="first last">if there are input cl arrays.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(numpy/cl complex array [N])</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.phase_factor_qrf_inplace">
<code class="descname">phase_factor_qrf_inplace</code><span class="sig-paren">(</span><em>q</em>, <em>r</em>, <em>f</em>, <em>R=None</em>, <em>q_is_qdev=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.phase_factor_qrf_inplace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.phase_factor_qrf_inplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate diffraction amplitudes: sum over f_n*exp(-iq.r_n)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>q</strong> (<em>numpy/cl float array</em><em> [</em><em>N</em><em>,</em><em>3</em><em>]</em>) – Scattering vectors (2pi/lambda).</li>
<li><strong>r</strong> (<em>numpy/cl float array</em><em> [</em><em>M</em><em>,</em><em>3</em><em>]</em>) – Atomic coordinates.</li>
<li><strong>f</strong> (<em>numpy/cl complex array</em><em> [</em><em>M</em><em>]</em>) – Complex scattering factors.</li>
<li><strong>R</strong> (<em>numpy array</em><em> [</em><em>3</em><em>,</em><em>3</em><em>]</em>) – Rotation matrix acting on q vectors.</li>
<li><strong>a</strong> (<em>cl complex array</em><em> [</em><em>N</em><em>]</em>) – Optional container for complex scattering
amplitudes.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>Diffraction amplitudes.  Will be a cl array</dt>
<dd><p class="first last">if there are input cl arrays.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(numpy/cl complex array [N])</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.next_multiple_groupsize">
<code class="descname">next_multiple_groupsize</code><span class="sig-paren">(</span><em>N</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.next_multiple_groupsize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.next_multiple_groupsize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.init_amps">
<code class="descname">init_amps</code><span class="sig-paren">(</span><em>Npix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.init_amps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.init_amps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.release_amps">
<code class="descname">release_amps</code><span class="sig-paren">(</span><em>reset=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.release_amps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.release_amps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.phase_factor_qrf">
<code class="descname">phase_factor_qrf</code><span class="sig-paren">(</span><em>q</em>, <em>r</em>, <em>f</em>, <em>R=None</em>, <em>a=None</em>, <em>add=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.phase_factor_qrf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.phase_factor_qrf" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate diffraction amplitudes: sum over f_n*exp(-iq.r_n)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>q</strong> (<em>numpy/cl float array</em><em> [</em><em>N</em><em>,</em><em>3</em><em>]</em>) – Scattering vectors (2pi/lambda).</li>
<li><strong>r</strong> (<em>numpy/cl float array</em><em> [</em><em>M</em><em>,</em><em>3</em><em>]</em>) – Atomic coordinates.</li>
<li><strong>R</strong> (<em>numpy array</em><em> [</em><em>3</em><em>,</em><em>3</em><em>]</em>) – Rotation matrix acting on q vectors.</li>
<li><strong>f</strong> (<em>numpy/cl complex array</em><em> [</em><em>M</em><em>]</em>) – Complex scattering factors.</li>
<li><strong>a</strong> (<em>cl complex array</em><em> [</em><em>N</em><em>]</em>) – Optional container for complex scattering
amplitudes.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>Diffraction amplitudes.  Will be a cl array</dt>
<dd><p class="first last">if there are input cl arrays.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(numpy/cl complex array [N])</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.phase_factor_pad">
<code class="descname">phase_factor_pad</code><span class="sig-paren">(</span><em>r</em>, <em>f</em>, <em>T</em>, <em>F</em>, <em>S</em>, <em>B</em>, <em>nF</em>, <em>nS</em>, <em>w</em>, <em>R=None</em>, <em>a=None</em>, <em>add=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.phase_factor_pad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.phase_factor_pad" title="Permalink to this definition">¶</a></dt>
<dd><p>This should simulate detector panels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r</strong> – An Nx3 numpy array with atomic coordinates (meters)</li>
<li><strong>f</strong> – A numpy array with complex scattering factors</li>
<li><strong>T</strong> – A 1x3 numpy array with vector components pointing from sample to
the center of the first pixel in memory</li>
<li><strong>F</strong> – A 1x3 numpy array containing the basis vector components pointing
in the direction corresponding to contiguous pixels in memory
(“fast scan”).</li>
<li><strong>S</strong> – A 1x3 numpy array containing the basis vector components pointing
in the direction corresponding to non-contiguous pixels in
memory (“slow scan”).</li>
<li><strong>B</strong> – A 1x3 numpy array with unit-vector components corresponding to the
incident x-ray beam direction</li>
<li><strong>nF</strong> – Number of fast-scan pixels (corresponding to F vector) in the
detector panel</li>
<li><strong>nS</strong> – Number of slow-scan pixels (corresponding to S vector) in the
detector panel</li>
<li><strong>w</strong> – The photon wavelength in meters</li>
<li><strong>R</strong> – Optional numpy array [3x3] specifying rotation of q vectors</li>
<li><strong>a</strong> – Optional output complex scattering amplitude cl array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A numpy array of length nF*nS containing complex scattering</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">A</p>
</td>
</tr>
</tbody>
</table>
<p>amplitudes</p>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.phase_factor_mesh">
<code class="descname">phase_factor_mesh</code><span class="sig-paren">(</span><em>r</em>, <em>f</em>, <em>N</em>, <em>q_min</em>, <em>q_max</em>, <em>a=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.phase_factor_mesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.phase_factor_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute phase factors on a regular 3D mesh of q-space samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r</strong> (<em>Nx3 numpy array</em>) – Atomic coordinates</li>
<li><strong>f</strong> (<em>numpy array</em>) – A numpy array of complex atomic scattering factors</li>
<li><strong>N</strong> (<em>numpy array length 3</em>) – Number of q-space samples in each of the three
dimensions</li>
<li><strong>q_min</strong> (<em>numpy array length 3</em>) – Minimum q-space magnitudes in the 3d mesh.
These values specify the <em>center</em> of the first voxel.</li>
<li><strong>q_max</strong> (<em>numpy array length 3</em>) – Naximum q-space magnitudes in the 3d mesh.
These values specify the <em>center</em> of the voxel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>An array of complex scattering amplitudes.  By default this is a normal</dt>
<dd><p class="first last">numpy array.  Optionally, this may be an opencl buffer.</p>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.buffer_mesh_lookup">
<code class="descname">buffer_mesh_lookup</code><span class="sig-paren">(</span><em>a_map</em>, <em>N</em>, <em>q_min</em>, <em>q_max</em>, <em>q</em>, <em>R=None</em>, <em>a=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.buffer_mesh_lookup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.buffer_mesh_lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>This is supposed to lookup intensities from a 3d mesh of amplitudes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a_map</strong> (<em>numpy array</em>) – Complex scattering amplitudes (usually generated from
the function phase_factor_mesh())</li>
<li><strong>N</strong> (<em>int</em>) – As defined in phase_factor_mesh()</li>
<li><strong>q_min</strong> (<em>float</em>) – As defined in phase_factor_mesh()</li>
<li><strong>q_max</strong> (<em>float</em>) – As defined in phase_factor_mesh()</li>
<li><strong>q</strong> (<em>Nx3 numpy array</em>) – q-space coordinates at which we want to interpolate
the complex amplitudes in a_dev</li>
<li><strong>R</strong> (<em>3x3 numpy array</em>) – Rotation matrix that will act on the q vectors</li>
<li><strong>a</strong> – (clarray) The output array (optional)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">numpy array of complex amplitudes</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.lattice_transform_intensities_pad">
<code class="descname">lattice_transform_intensities_pad</code><span class="sig-paren">(</span><em>abc</em>, <em>N</em>, <em>T</em>, <em>F</em>, <em>S</em>, <em>B</em>, <em>nF</em>, <em>nS</em>, <em>w</em>, <em>R=None</em>, <em>I=None</em>, <em>add=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.lattice_transform_intensities_pad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.lattice_transform_intensities_pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate crystal lattice transform intensities for a pixel-array detector.  This is the usual transform for
an idealized parallelepiped crystal (usually not very realistic…).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>abc</strong> (<em>numpy array</em>) – A 3x3 array containing real-space basis vectors.  Vectors are contiguous in memory.</li>
<li><strong>N</strong> (<em>numpy array</em>) – An array containing number of unit cells along each of three axes.</li>
<li><strong>T</strong> (<em>numpy array</em>) – Translation to center of corner pixel.</li>
<li><strong>F</strong> (<em>numpy array</em>) – Fast-scan basis vector.</li>
<li><strong>S</strong> (<em>numpy array</em>) – Slow-scan basis vector.</li>
<li><strong>B</strong> (<em>numpy array</em>) – Incident beam vector.</li>
<li><strong>nF</strong> (<em>int</em>) – Number of fast-scan pixels.</li>
<li><strong>nS</strong> (<em>int</em>) – Number of slow-scan pixels.</li>
<li><strong>w</strong> (<em>float</em>) – Wavelength.</li>
<li><strong>R</strong> (<em>numpy array</em>) – Rotation matrix acting on q vectors.</li>
<li><strong>(</strong> (<em>I</em>) – class:pyopencl.array.Array) : OpenCL device array containing intensities.</li>
<li><strong>add</strong> (<em>bool</em>) – If true, the function will add to the input I buffer, else the buffer is overwritten.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">If I == None, then the output is a numpy array.  Otherwise, it is an opencl array.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.gaussian_lattice_transform_intensities_pad">
<code class="descname">gaussian_lattice_transform_intensities_pad</code><span class="sig-paren">(</span><em>abc</em>, <em>N</em>, <em>T</em>, <em>F</em>, <em>S</em>, <em>B</em>, <em>nF</em>, <em>nS</em>, <em>w</em>, <em>R=None</em>, <em>I=None</em>, <em>add=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.gaussian_lattice_transform_intensities_pad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.gaussian_lattice_transform_intensities_pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate crystal lattice transform intensities for a pixel-array detector.  Uses a Gaussian approximation
to the lattice transform.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>abc</strong> (<em>numpy array</em>) – A 3x3 array containing real-space basis vectors.  Vectors are contiguous in memory.</li>
<li><strong>N</strong> (<em>numpy array</em>) – An array containing number of unit cells along each of three axes.</li>
<li><strong>T</strong> (<em>numpy array</em>) – Translation to center of corner pixel.</li>
<li><strong>F</strong> (<em>numpy array</em>) – Fast-scan basis vector.</li>
<li><strong>S</strong> (<em>numpy array</em>) – Slow-scan basis vector.</li>
<li><strong>B</strong> (<em>numpy array</em>) – Incident beam vector.</li>
<li><strong>nF</strong> (<em>int</em>) – Number of fast-scan pixels.</li>
<li><strong>nS</strong> (<em>int</em>) – Number of slow-scan pixels.</li>
<li><strong>w</strong> (<em>float</em>) – Wavelength.</li>
<li><strong>R</strong> (<em>numpy array</em>) – Rotation matrix acting on q vectors.</li>
<li><strong>(</strong> (<em>I</em>) – class:pyopencl.array.Array) : OpenCL device array containing intensities.</li>
<li><strong>add</strong> (<em>bool</em>) – If true, the function will add to the input I buffer, else the buffer is overwritten.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">If I == None, then the output is a numpy array.  Otherwise, it is an opencl array.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.prime_cromermann_simulator">
<code class="descname">prime_cromermann_simulator</code><span class="sig-paren">(</span><em>q_vecs</em>, <em>atomic_nums=None</em>, <em>incoherent=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.prime_cromermann_simulator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.prime_cromermann_simulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare special array data for cromermann simulation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>q_vecs</strong> (<em>np.ndarray</em>) – Npixels x 3 array of cartesian pixels qx, qy, qz</li>
<li><strong>atomic_num</strong> (<em>np.ndarray</em>) – Natoms x 1 array of atomic numbers corresponding
to the atoms in the target</li>
<li><strong>bool</strong> (<em>incoherent</em>) – Whether to make form factors random</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.get_r_cromermann">
<code class="descname">get_r_cromermann</code><span class="sig-paren">(</span><em>atom_vecs</em>, <em>sub_com=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.get_r_cromermann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.get_r_cromermann" title="Permalink to this definition">¶</a></dt>
<dd><p>combine atomic vectors and atomic flux factors
into an openCL buffer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom_vecs</strong> (<em>np.ndarray</em>) – Atomic positions</li>
<li><strong>sub_com</strong> (<em>bool</em>) – Whether to sub the center of mass from the atom vecs</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Natoms x 4 contiguous openCL buffer array</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pyopenCL buffer data</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.get_q_cromermann">
<code class="descname">get_q_cromermann</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.get_q_cromermann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.get_q_cromermann" title="Permalink to this definition">¶</a></dt>
<dd><p>combine form factors and q-vectors and load onto a CL buffer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>q_vecs</strong> (<em>np.ndarray</em>) – Npixels x 3 array (inverse angstroms)</li>
<li><strong>atomic_nums</strong> (<em>np.ndarray</em>) – Natoms x 1 array of atomic numbers</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Npixelbuff x 16 contiguous openCL buffer array
where Npixel buff is the first multiple of
group_size that is greater than Npixels</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pyopenCL buffer data</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.run_cromermann">
<code class="descname">run_cromermann</code><span class="sig-paren">(</span><em>q_buff_data</em>, <em>r_buff_data</em>, <em>rand_rot=False</em>, <em>force_rot_mat=None</em>, <em>com=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.run_cromermann"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.run_cromermann" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the qrf kam simulator.</p>
<dl class="docutils">
<dt>Arguments</dt>
<dd><dl class="first last docutils">
<dt>q_buff_data (pyopenCL buffer data) :</dt>
<dd>should have shape NpixelsCLx16 where
NpixelsCL is the first multiple of group_size greater than
Npixels.
Use <a class="reference internal" href="#bornagain.simulate.clcore.ClCore.get_group_size" title="bornagain.simulate.clcore.ClCore.get_group_size"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_group_size()</span></code></a> to check the currently
set group_size. The data stored in
q[Npixels,:3] should be the q-vectors.
The data stored in q[Npixels,3:Nspecies] should be the
q-dependent atomic form factors for up to Nspecies=13
atom species See <code class="xref py py-func docutils literal notranslate"><span class="pre">prime_comermann_simulator()</span></code>
for details regarding the form factor storage and atom
species identifier</dd>
<dt>r_buff_data (pyopenCL buffer data) :</dt>
<dd>Should have shape Natomsx4. The data stored in
r_buff_data[:,:3] are the atomic positions in cartesian
(x,y,z).  The data stored in r_buff_data[:,3] are
the atom species identifiers (0,1,..Nspecies-1)
mapping the atom species here to the form factor value
in q_buff_data.</dd>
<dt>rand_rot (bool) :</dt>
<dd>Randomly rotate the molecule</dd>
<dt>force_rand_rot (np.ndarray) :</dt>
<dd>Supply a specific rotation matrix</dd>
<dt>com (np.ndarray) :</dt>
<dd>Offset the center of mass of the molecule</dd>
</dl>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For atom r_i the atom species identifier is sp_i =
r_buff_data[r_i,3].
Then, for pixel q_i, the simulator can find the corresponding
form factor in q_buff_dat[q_i,3+sp_i].
I know it is confusing, but it’s efficient.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.clcore.ClCore.release_amplitudes">
<code class="descname">release_amplitudes</code><span class="sig-paren">(</span><em>reset=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#ClCore.release_amplitudes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.ClCore.release_amplitudes" title="Permalink to this definition">¶</a></dt>
<dd><p>Releases the amplitude buffer from the GPU</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>reset</strong> (<em>bool</em>) – Reset the amplitude buffer to 0’s on the GPU</td>
</tr>
</tbody>
</table>
<p>Returns (np.ndarray) : Scattering amplitudes</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="bornagain.simulate.clcore.helpme">
<code class="descclassname">bornagain.simulate.clcore.</code><code class="descname">helpme</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#helpme"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.helpme" title="Permalink to this definition">¶</a></dt>
<dd><p>Print out some useful information about platforms and devices that are
available for running simulations.</p>
</dd></dl>

<dl class="function">
<dt id="bornagain.simulate.clcore.test">
<code class="descclassname">bornagain.simulate.clcore.</code><code class="descname">test</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/clcore.html#test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.clcore.test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-bornagain.simulate.examples">
<span id="bornagain-simulate-examples-module"></span><h2>bornagain.simulate.examples module<a class="headerlink" href="#module-bornagain.simulate.examples" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="bornagain.simulate.examples.lysozyme_molecule">
<code class="descclassname">bornagain.simulate.examples.</code><code class="descname">lysozyme_molecule</code><span class="sig-paren">(</span><em>pads=None</em>, <em>wavelength=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/examples.html#lysozyme_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.examples.lysozyme_molecule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-bornagain.simulate.refdata">
<span id="bornagain-simulate-refdata-module"></span><h2>bornagain.simulate.refdata module<a class="headerlink" href="#module-bornagain.simulate.refdata" title="Permalink to this headline">¶</a></h2>
<p>refdata.py – reference data and tables used in computations</p>
<dl class="function">
<dt id="bornagain.simulate.refdata.get_cmann_form_factors">
<code class="descclassname">bornagain.simulate.refdata.</code><code class="descname">get_cmann_form_factors</code><span class="sig-paren">(</span><em>cman</em>, <em>q</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/refdata.html#get_cmann_form_factors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.refdata.get_cmann_form_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>cman is a dict of {atomic_number : array of cman parameters}</p>
<p>q is either  a Nq x 3 , or a 1x3 vector of reciprocal space points, magnitudes respectively</p>
</dd></dl>

<dl class="function">
<dt id="bornagain.simulate.refdata.get_cromermann_parameters">
<code class="descclassname">bornagain.simulate.refdata.</code><code class="descname">get_cromermann_parameters</code><span class="sig-paren">(</span><em>atomic_numbers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/refdata.html#get_cromermann_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.refdata.get_cromermann_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Modified from tjlane/thor.git
Get cromer-mann parameters for each atom type</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atomic_numbers</strong> (<em>ndarray</em><em>, </em><em>int</em>) – A numpy array of the atomic numbers of each atom in the system.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The Cromer-Mann parameters for the system. The dictionary
key corresponds to the atomic number, and the parameters
are listed in order as a_1,a_2,a_3,a_4,b_1,b_2,b_3,b_4,c</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">cromermann (dict)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bornagain.simulate.refdata.get_cromermann_parameters_legacy">
<code class="descclassname">bornagain.simulate.refdata.</code><code class="descname">get_cromermann_parameters_legacy</code><span class="sig-paren">(</span><em>atomic_numbers</em>, <em>max_num_atom_types=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/refdata.html#get_cromermann_parameters_legacy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.refdata.get_cromermann_parameters_legacy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get cromer-mann parameters for each atom type and renumber the atom
types to 0, 1, 2, … to point to their CM params.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atomic_numbers</strong> (<em>ndarray</em><em>, </em><em>int</em>) – A numpy array of the atomic numbers of each atom in the system.</li>
<li><strong>max_num_atom_types</strong> (<em>int</em>) – The maximium number of atom types allowable</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>The Cromer-Mann parameters for the system. Positions [(0-8) * aid] are</dt>
<dd><p class="first last">reserved for each atom type in the system (see <cite>aid</cite> below).</p>
</dd>
<dt>aid (c-array, int) :</dt>
<dd><p class="first last">The indicies of the atomic ids of each atom in the system. This is an
arbitrary compressed index for use within the scattering code. Really
this is just a renumbering so that each atom type recieves an index
0, 1, 2, … corresponding to the position of that atom’s type in
the <cite>cromermann</cite> array.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">cromermann (c-array, float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-bornagain.simulate.simutils">
<span id="bornagain-simulate-simutils-module"></span><h2>bornagain.simulate.simutils module<a class="headerlink" href="#module-bornagain.simulate.simutils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="bornagain.simulate.simutils.sphericalize">
<code class="descclassname">bornagain.simulate.simutils.</code><code class="descname">sphericalize</code><span class="sig-paren">(</span><em>lattice</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/simutils.html#sphericalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.simutils.sphericalize" title="Permalink to this definition">¶</a></dt>
<dd><p>attempt to sphericalize a 2D lattice point array</p>
</dd></dl>

<dl class="function">
<dt id="bornagain.simulate.simutils.area_beam">
<code class="descclassname">bornagain.simulate.simutils.</code><code class="descname">area_beam</code><span class="sig-paren">(</span><em>lb</em>, <em>r</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/simutils.html#area_beam"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.simutils.area_beam" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the cross sectional area of illuminated
solvent assuming no crystal is present. if the beam side length
is greater than 2r it reutrns the cross-sectional area of the jet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lb</strong> (<em>the side length of the beam</em>) – </li>
<li><strong>r</strong> (<em>the radius of the jet</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float value of the cross sectional area of illuminated jet</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bornagain.simulate.simutils.area_crys">
<code class="descclassname">bornagain.simulate.simutils.</code><code class="descname">area_crys</code><span class="sig-paren">(</span><em>lc</em>, <em>r</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/simutils.html#area_crys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.simutils.area_crys" title="Permalink to this definition">¶</a></dt>
<dd><p>This function finds the exposed cross-sectional area of solvent
from a cubic crystal and cylindrical jet. If the crystal is larger
than the beam it returns zero. Its mainly used in the function
“volume_solvent.”</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lc</strong> (<em>the side length of the crystal</em>) – </li>
<li><strong>r</strong> (<em>the radius of the jet</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">a float value for the cross-sectional area of illuminated solvent</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bornagain.simulate.simutils.volume_solvent">
<code class="descclassname">bornagain.simulate.simutils.</code><code class="descname">volume_solvent</code><span class="sig-paren">(</span><em>lb</em>, <em>lc</em>, <em>r</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/simutils.html#volume_solvent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.simutils.volume_solvent" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the volume of illuminated solvent assuming
a “square” beam, a cubic crystal and a cylindrical jet of solvent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lb</strong> (<em>The side length of the square beam</em>) – </li>
<li><strong>lc</strong> (<em>The side length of the cubuc crystal</em>) – </li>
<li><strong>r</strong> (<em>The radius of the solvent jet</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float value of the volume of illuminated solvent</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-bornagain.simulate.solutions">
<span id="bornagain-simulate-solutions-module"></span><h2>bornagain.simulate.solutions module<a class="headerlink" href="#module-bornagain.simulate.solutions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="bornagain.simulate.solutions.load_data">
<code class="descclassname">bornagain.simulate.solutions.</code><code class="descname">load_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/solutions.html#load_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.solutions.load_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bornagain.simulate.solutions.get_water_profile">
<code class="descclassname">bornagain.simulate.solutions.</code><code class="descname">get_water_profile</code><span class="sig-paren">(</span><em>q</em>, <em>temperature=298</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/solutions.html#get_water_profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.solutions.get_water_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Get water scattering profile from Greg Hura’s PhD thesis data.  Interpolates the data for given
q-vector magnitudes and temperature.  Temperatures range from 1, 11, 25, 44, 55, 66, 77 degrees
Celcius.  Bornagain, of course, uses SI units, including for temperature.  To go from Celcius to Kelvin, add 273.16.
Note that this is the scattering factor F for a single water molecule.  The number density of water is approximately
n = 33.3679e27 / m^3 .</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>q</strong> – The momentum transfer vector magnitudes (i.e. 2 pi sin(theta/lambda)/wavelength )</li>
<li><strong>temperature</strong> – Desired water temperature in Kelvin</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns:</p>
</dd></dl>

</div>
<div class="section" id="module-bornagain.simulate.thorn">
<span id="bornagain-simulate-thorn-module"></span><h2>bornagain.simulate.thorn module<a class="headerlink" href="#module-bornagain.simulate.thorn" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="bornagain.simulate.thorn.nextPow2">
<code class="descclassname">bornagain.simulate.thorn.</code><code class="descname">nextPow2</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#bornagain.simulate.thorn.nextPow2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bornagain.simulate.thorn.prevPow2">
<code class="descclassname">bornagain.simulate.thorn.</code><code class="descname">prevPow2</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#bornagain.simulate.thorn.prevPow2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bornagain.simulate.thorn.make_q_vectors">
<code class="descclassname">bornagain.simulate.thorn.</code><code class="descname">make_q_vectors</code><span class="sig-paren">(</span><em>qmin</em>, <em>qmax</em>, <em>wavelen</em>, <em>dq=0.02</em>, <em>dphi=0.05</em>, <em>pow2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/thorn.html#make_q_vectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.thorn.make_q_vectors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="bornagain.simulate.thorn.ThornAgain">
<em class="property">class </em><code class="descclassname">bornagain.simulate.thorn.</code><code class="descname">ThornAgain</code><span class="sig-paren">(</span><em>q_vecs</em>, <em>atom_vecs</em>, <em>atomic_nums=None</em>, <em>which='default'</em>, <em>group_size=32</em>, <em>cpu=False</em>, <em>sub_com=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/thorn.html#ThornAgain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.thorn.ThornAgain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="bornagain.simulate.thorn.ThornAgain.set_groupsize">
<code class="descname">set_groupsize</code><span class="sig-paren">(</span><em>group_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/thorn.html#ThornAgain.set_groupsize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.thorn.ThornAgain.set_groupsize" title="Permalink to this definition">¶</a></dt>
<dd><p>If the environment variable BORNAGAIN_CL_GROUPSIZE is set then use
that value.</p>
<p>If the group size exceeds the max allowed group size, then make it
smaller (but print warning)</p>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.thorn.ThornAgain.load_program">
<code class="descname">load_program</code><span class="sig-paren">(</span><em>which</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/thorn.html#ThornAgain.load_program"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.thorn.ThornAgain.load_program" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bornagain.simulate.thorn.ThornAgain.update_rbuff">
<code class="descname">update_rbuff</code><span class="sig-paren">(</span><em>new_atoms</em>, <em>new_z=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/thorn.html#ThornAgain.update_rbuff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.thorn.ThornAgain.update_rbuff" title="Permalink to this definition">¶</a></dt>
<dd><p>new_atoms, float Nx3 of atoms
new_z, float Nx1 atomic numbers</p>
</dd></dl>

<dl class="method">
<dt id="bornagain.simulate.thorn.ThornAgain.run_transient">
<code class="descname">run_transient</code><span class="sig-paren">(</span><em>rand_rot=False</em>, <em>force_rot_mat=None</em>, <em>com=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/thorn.html#ThornAgain.run_transient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.thorn.ThornAgain.run_transient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bornagain.simulate.thorn.ThornAgain.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>rand_rot=False</em>, <em>force_rot_mat=None</em>, <em>com=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/thorn.html#ThornAgain.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.thorn.ThornAgain.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bornagain.simulate.thorn.ThornAgain.release_amplitudes">
<code class="descname">release_amplitudes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/thorn.html#ThornAgain.release_amplitudes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.thorn.ThornAgain.release_amplitudes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="bornagain.simulate.thorn.test">
<code class="descclassname">bornagain.simulate.thorn.</code><code class="descname">test</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bornagain/simulate/thorn.html#test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bornagain.simulate.thorn.test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-bornagain.simulate">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-bornagain.simulate" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="bornagain.target.html" class="btn btn-neutral float-right" title="bornagain.target package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="bornagain.external.pyqtgraph.html" class="btn btn-neutral" title="bornagain.external.pyqtgraph package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Richard A Kirian.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>